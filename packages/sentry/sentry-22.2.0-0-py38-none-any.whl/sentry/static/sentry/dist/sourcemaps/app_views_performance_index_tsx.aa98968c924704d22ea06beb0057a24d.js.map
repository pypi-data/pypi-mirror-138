{"version":3,"file":"chunks/app_views_performance_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"8fAcA,SAASA,EAAT,GAA+D,IAAjC,aAACC,EAAD,SAAeC,GAAkB,EAS7D,OACE,QAAC,IAAD,CACEC,SAAS,oCACTC,SAAU,CAAC,oBACXH,aAAcA,EACdI,eAbJ,WACE,OACE,QAAC,KAAD,WACE,QAAC,IAAD,CAAOC,KAAK,UAAZ,UAAuBC,EAAAA,EAAAA,GAAE,8CAM7B,UAME,QAAC,KAAD,UAAgCL,MAhB7BF,EAAAA,YAAAA,uBAqBT,SAAeQ,EAAAA,EAAAA,GAAiBR,I,0lBCzBhC,MAAMS,EAAe,yBAMrB,SAASC,EAAT,GAA2D,IAApC,SAACC,GAAmC,EACzD,MAAMV,GAAeW,EAAAA,EAAAA,MACf,cAACC,EAAD,iBAAgBC,GAAoBC,IAO1C,OACE,QAAC,IAAD,CAASX,SAAU,CAACK,GAAeR,aAAcA,EAAjD,UACE,QAACe,EAAD,YACGT,EAAAA,EAAAA,GAAE,iBACH,QAAC,IAAD,CAAQU,SAAUJ,EAAeK,OATvC,WACEP,IACAG,GAAkBD,IAOyCM,KAAK,YAb3DT,EAAAA,YAAAA,gBAmBT,MAAMM,GAAQ,OAAO,QAAP,qBAAH,+EAKFI,EAAAA,EAAAA,GAAM,GALJ,wBASLC,GAAuBC,EAAAA,EAAAA,eAAc,CACzCT,eAAe,EACfC,iBAAmBS,QAGrB,SAASC,EAAT,GAAgF,IAAzC,SAACtB,GAAwC,EAC9E,MAAMD,GAAeW,EAAAA,EAAAA,KACfa,EAAmB,uBAAsBxB,EAAayB,QACrDb,EAAeC,IAAoBa,EAAAA,EAAAA,UACE,SAA1CC,EAAAA,EAAAA,QAAqBH,IAQvB,OACE,QAACJ,EAAqBQ,SAAtB,CACEC,MAAO,CACLjB,cAAeA,GAAiBZ,EAAaG,SAAS2B,SAAStB,GAC/DK,iBATN,SAAgCgB,GAC9BF,EAAAA,EAAAA,QAAqBH,EAAiBK,EAAME,YAC5ClB,EAAiBgB,KAIjB,SAMG5B,IAKP,SAASa,IAGP,OAFqBkB,EAAAA,EAAAA,YAAWZ,GAzBzBG,EAAAA,YAAAA","sources":["webpack:///./app/views/performance/index.tsx","webpack:///./app/views/performance/metricsSwitch.tsx"],"sourcesContent":["import Feature from 'sentry/components/acl/feature';\nimport Alert from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\nimport {PageContent} from 'sentry/styles/organization';\nimport {Organization} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\n\nimport {MetricsSwitchContextContainer} from './metricsSwitch';\n\ntype Props = {\n  children: React.ReactChildren;\n  organization: Organization;\n};\n\nfunction PerformanceContainer({organization, children}: Props) {\n  function renderNoAccess() {\n    return (\n      <PageContent>\n        <Alert type=\"warning\">{t(\"You don't have access to this feature\")}</Alert>\n      </PageContent>\n    );\n  }\n\n  return (\n    <Feature\n      hookName=\"feature-disabled:performance-page\"\n      features={['performance-view']}\n      organization={organization}\n      renderDisabled={renderNoAccess}\n    >\n      <MetricsSwitchContextContainer>{children}</MetricsSwitchContextContainer>\n    </Feature>\n  );\n}\n\nexport default withOrganization(PerformanceContainer);\n","import {createContext, useContext, useState} from 'react';\nimport styled from '@emotion/styled';\n\nimport Feature from 'sentry/components/acl/feature';\nimport Switch from 'sentry/components/switchButton';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport localStorage from 'sentry/utils/localStorage';\nimport useOrganization from 'sentry/utils/useOrganization';\n\nconst FEATURE_FLAG = 'metrics-performance-ui';\n\n/**\n * This is a temporary component used for debugging metrics data on performance pages.\n * Visible only to small amount of internal users.\n */\nfunction MetricsSwitch({onSwitch}: {onSwitch: () => void}) {\n  const organization = useOrganization();\n  const {isMetricsData, setIsMetricsData} = useMetricsSwitch();\n\n  function handleToggle() {\n    onSwitch();\n    setIsMetricsData(!isMetricsData);\n  }\n\n  return (\n    <Feature features={[FEATURE_FLAG]} organization={organization}>\n      <Label>\n        {t('Metrics Data')}\n        <Switch isActive={isMetricsData} toggle={handleToggle} size=\"lg\" />\n      </Label>\n    </Feature>\n  );\n}\n\nconst Label = styled('label')`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 0;\n  gap: ${space(1)};\n  font-weight: normal;\n`;\n\nconst MetricsSwitchContext = createContext({\n  isMetricsData: false,\n  setIsMetricsData: (_isMetricsData: boolean) => {},\n});\n\nfunction MetricsSwitchContextContainer({children}: {children: React.ReactNode}) {\n  const organization = useOrganization();\n  const localStorageKey = `metrics.performance:${organization.slug}`;\n  const [isMetricsData, setIsMetricsData] = useState(\n    localStorage.getItem(localStorageKey) === 'true'\n  );\n\n  function handleSetIsMetricsData(value: boolean) {\n    localStorage.setItem(localStorageKey, value.toString());\n    setIsMetricsData(value);\n  }\n\n  return (\n    <MetricsSwitchContext.Provider\n      value={{\n        isMetricsData: isMetricsData && organization.features.includes(FEATURE_FLAG),\n        setIsMetricsData: handleSetIsMetricsData,\n      }}\n    >\n      {children}\n    </MetricsSwitchContext.Provider>\n  );\n}\n\nfunction useMetricsSwitch() {\n  const contextValue = useContext(MetricsSwitchContext);\n\n  return contextValue;\n}\n\nexport {\n  MetricsSwitch,\n  MetricsSwitchContextContainer,\n  useMetricsSwitch,\n  MetricsSwitchContext,\n};\n"],"names":["PerformanceContainer","organization","children","hookName","features","renderDisabled","type","t","withOrganization","FEATURE_FLAG","MetricsSwitch","onSwitch","useOrganization","isMetricsData","setIsMetricsData","useMetricsSwitch","Label","isActive","toggle","size","space","MetricsSwitchContext","createContext","_isMetricsData","MetricsSwitchContextContainer","localStorageKey","slug","useState","localStorage","Provider","value","includes","toString","useContext"],"sourceRoot":""}