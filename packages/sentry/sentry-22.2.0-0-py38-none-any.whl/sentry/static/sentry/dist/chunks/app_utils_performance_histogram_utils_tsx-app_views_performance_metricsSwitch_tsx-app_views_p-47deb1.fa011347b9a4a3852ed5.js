"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_performance_histogram_utils_tsx-app_views_performance_metricsSwitch_tsx-app_views_p-47deb1"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>q});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),a=s("../node_modules/lodash/assign.js"),i=s.n(a),l=s("../node_modules/lodash/flatten.js"),c=s.n(l),p=s("../node_modules/lodash/isEqual.js"),d=s.n(p),u=s("../node_modules/lodash/memoize.js"),m=s.n(u),h=s("../node_modules/lodash/omit.js"),g=s.n(h),f=s("./app/actionCreators/tags.tsx"),x=s("./app/components/smartSearchBar/index.tsx"),v=s("./app/constants/index.tsx"),y=s("./app/types/index.tsx"),Z=s("./app/utils.tsx"),w=s("./app/utils/discover/fields.tsx"),b=s("./app/utils/measurements/measurements.tsx"),j=s("./app/utils/withApi.tsx"),_=s("./app/utils/withTags.tsx"),T=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S=new RegExp(`^${v.c$}|\\${v.ir}`,"g");class P extends n.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"getEventFieldValues",m()(((e,t,s)=>{const{api:r,organization:n,projectIds:o,includeSessionTagsValues:a}=this.props,i=null==o?void 0:o.map(String);return(0,w.h1)(e.key)||(0,w.Xr)(e.key)?Promise.resolve([]):(0,f.Fo)(r,n.slug,e.key,t,i,s,!0,a).then((e=>c()(e.filter((e=>{let{name:t}=e;return(0,Z.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`}))),(0,r.Z)(this,"prepareQuery",(e=>e.replace(S,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;d()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:r,omitTags:n}=this.props,o=t?Object.fromEntries(t.filter((e=>!Object.keys(w.wZ).includes(e.field)&&!(0,w.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},a=s.features.includes("performance-view")?Object.assign({},e,w.wZ,o):g()(w.wZ,w.J8),l=i()({},r,a,w.jg);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},g()(l,null!=n?n:[])}render(){const{organization:e}=this.props;return(0,T.tZ)(b.Z,{organization:e,children:e=>{let{measurements:t}=e;const s=this.getTagList(t);return(0,T.tZ)(o.ms,{children:e=>{let{css:t}=e;return(0,T.tZ)(x.Z,{hasRecentSearches:!0,savedSearchType:y.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:s,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:t`
                    max-height: 300px;
                    overflow-y: auto;
                  `,...this.props})}})}})}}P.displayName="SearchBar";const q=(0,j.Z)((0,_.Z)(P))},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>p}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),n=s("./app/utils/performance/vitals/constants.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,s]=e;return[t,{name:s.name,key:t}]})))}const i=a(n.TT),l=a(n.r9);function c(e){let{organization:t,children:s}=e;const n=t.features.includes("performance-mobile-vitals")?{...l,...i}:l;return(0,o.tZ)(r.Fragment,{children:s({measurements:n})})}c.displayName="Measurements";const p=c},"./app/utils/performance/histogram/utils.tsx":(e,t,s)=>{s.d(t,{te:()=>n,_W:()=>o,GT:()=>a});var r=s("./app/utils/formatters.tsx");function n(e){return e.length>=2?e[1].bin-e[0].bin:0}function o(e){const t=n(e);return e.map((e=>{const s=e.bin;return{start:s,end:s+t}}))}function a(e){let{precision:t,type:s,additionalFieldsFn:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=e=>{switch(s){case"duration":const n=null!=t?t:e<1e3?0:3;return(0,r.g9)(e/1e3,n,!0);case"number":const o=10**(null!=t?t:0);return(Math.round((e+Number.EPSILON)*o)/o).toLocaleString();default:throw new Error(`Unable to format type: ${s}`)}};return e.map((e=>{var t;return{value:e.count,name:o(e.bin),...null!==(t=null==n?void 0:n(e.bin))&&void 0!==t?t:{}}}))}},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{tags:o.Z.getAllTags()}),(0,r.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,i.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,r.Z)(t,"displayName",`withTags(${(0,a.Z)(e)})`),t}},"./app/views/performance/metricsSwitch.tsx":(e,t,s)=>{s.d(t,{BR:()=>m,z5:()=>f,_4:()=>x,j9:()=>g});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("./app/components/acl/feature.tsx"),a=s("./app/components/switchButton.tsx"),i=s("./app/locale.tsx"),l=s("./app/styles/space.tsx"),c=s("./app/utils/localStorage.tsx"),p=s("./app/utils/useOrganization.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u="metrics-performance-ui";function m(e){let{onSwitch:t}=e;const s=(0,p.Z)(),{isMetricsData:r,setIsMetricsData:n}=x();return(0,d.tZ)(o.Z,{features:[u],organization:s,children:(0,d.BX)(h,{children:[(0,i.t)("Metrics Data"),(0,d.tZ)(a.Z,{isActive:r,toggle:function(){t(),n(!r)},size:"lg"})]})})}m.displayName="MetricsSwitch";const h=(0,r.Z)("label",{target:"euzi8um0"})("display:flex;align-items:center;justify-content:center;margin-bottom:0;gap:",(0,l.Z)(1),";font-weight:normal;"),g=(0,n.createContext)({isMetricsData:!1,setIsMetricsData:e=>{}});function f(e){let{children:t}=e;const s=(0,p.Z)(),r=`metrics.performance:${s.slug}`,[o,a]=(0,n.useState)("true"===c.Z.getItem(r));return(0,d.tZ)(g.Provider,{value:{isMetricsData:o&&s.features.includes(u),setIsMetricsData:function(e){c.Z.setItem(r,e.toString()),a(e)}},children:t})}function x(){return(0,n.useContext)(g)}f.displayName="MetricsSwitchContextContainer"},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(e,t,s)=>{s.d(t,{q3:()=>i,_S:()=>l,xr:()=>c,tb:()=>p,qg:()=>d,Zq:()=>u});var r=s("./app/locale.tsx"),n=s("./app/utils/queryString.tsx"),o=s("./app/views/performance/transactionSummary/filter.tsx"),a=s("./app/views/performance/transactionSummary/utils.tsx");let i;function l(e,t){const{p99:s,p95:n,p75:a,p50:l}=t||{p99:0,p95:0,p75:0,p50:0};return{[i.p50]:{name:i.p50,query:l?[["transaction.duration",`<=${l.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,o.T$)(e)||"transaction.duration"},label:(0,r.t)("p50")},[i.p75]:{name:i.p75,query:a?[["transaction.duration",`<=${a.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,o.T$)(e)||"transaction.duration"},label:(0,r.t)("p75")},[i.p95]:{name:i.p95,query:n?[["transaction.duration",`<=${n.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,o.T$)(e)||"transaction.duration"},label:(0,r.t)("p95")},[i.p99]:{name:i.p99,query:s?[["transaction.duration",`<=${s.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,o.T$)(e)||"transaction.duration"},label:(0,r.t)("p99")},[i.p100]:{name:i.p100,label:(0,r.t)("p100")}}}function c(e){let{orgSlug:t,transaction:s,projectID:r,query:n}=e;return{pathname:`/organizations/${t}/performance/summary/events/`,query:{transaction:s,project:r,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}function p(e){return t=(0,n.ro)(e.query.showTransactions,i.p100),Object.values(i).includes(t)?t:i.p100;var t}function d(e,t){var s,r;const n=l(t),o=null===(s=n[e].sort)||void 0===s?void 0:s.kind,a=null===(r=n[e].sort)||void 0===r?void 0:r.field,i={showTransactions:e};return o&&a&&(i.sort=`${"desc"===o?"-":""}${a}`),i}function u(e){switch(e){case a.K0.OUTLIER:return i.p100;case a.K0.SLOW:return i.p95;default:return}}!function(e){e.p50="p50",e.p75="p75",e.p95="p95",e.p99="p99",e.p100="p100"}(i||(i={}))},"./app/views/performance/trends/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/components/noProjectMessage.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),l=s("./app/locale.tsx"),c=s("./app/styles/organization.tsx"),p=s("./app/utils/withApi.tsx"),d=s("./app/utils/withOrganization.tsx"),u=s("./app/utils/withPageFilters.tsx"),m=s("./app/utils/withProjects.tsx"),h=s("./app/views/performance/data.tsx"),g=s("../node_modules/react-router/es/index.js"),f=s("./app/components/alert.tsx"),x=s("./app/components/breadcrumbs.tsx"),v=s("./app/components/dropdownControl.tsx"),y=s("./app/components/events/searchBar.tsx"),Z=s("./app/components/layouts/thirds.tsx"),w=s("./app/components/organizations/pageFilters/container.tsx"),b=s("./app/constants/index.tsx"),j=s("./app/icons/iconFlag.tsx"),_=s("./app/styles/space.tsx"),T=s("./app/utils/analytics.tsx"),S=s("./app/utils/discover/fields.tsx"),P=s("./app/utils/queryString.tsx"),q=s("./app/utils/tokenizeSearch.tsx"),E=s("./app/views/performance/utils.tsx"),z=s("./app/views/performance/trends/changedTransactions.tsx"),F=s("./app/views/performance/trends/types.tsx"),C=s("./app/views/performance/trends/utils.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class D extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{}),(0,r.Z)(this,"handleSearch",(e=>{const{location:t}=this.props,s=(0,C.Ws)();g.browserHistory.push({pathname:t.pathname,query:{...t.query,...s,query:String(e).trim()||void 0}})})),(0,r.Z)(this,"setError",(e=>{this.setState({error:e})})),(0,r.Z)(this,"handleTrendFunctionChange",(e=>{const{organization:t,location:s}=this.props,r={};Object.values(F.ER).forEach((e=>{const t=(0,C.j_)(e);r[t]=void 0})),(0,T.ec)({eventKey:"performance_views.trends.change_function",eventName:"Performance Views: Change Function",organization_id:parseInt(t.id,10),function_name:e}),this.setState({previousTrendFunction:(0,C.CE)(s).field});const n=(0,C.Ws)();g.browserHistory.push({pathname:s.pathname,query:{...s.query,...r,...n,trendFunction:e}})})),(0,r.Z)(this,"handleParameterChange",(e=>{const{organization:t,location:s}=this.props,r=(0,C.Ws)();(0,T.ec)({eventKey:"performance_views.trends.change_parameter",eventName:"Performance Views: Change Parameter",organization_id:parseInt(t.id,10),parameter_name:e}),g.browserHistory.push({pathname:s.pathname,query:{...s.query,...r,trendParameter:e}})}))}renderError(){const{error:e}=this.state;return e?(0,k.tZ)(f.Z,{type:"error",icon:(0,k.tZ)(j.G,{size:"md"}),children:e}):null}getPerformanceLink(){const{location:e}=this.props,t={...e.query},s=(0,P.ro)(e.query.query,""),r=new q.MY(s);return r.removeFilter("tpm()"),r.removeFilter("confidence()"),r.removeFilter("transaction.duration"),t.query=r.formatString(),{pathname:(0,E.de)(this.props.organization),query:t}}render(){const{organization:e,eventView:t,location:s,projects:r}=this.props,{previousTrendFunction:n}=this.state,o=t.clone();(0,C.iF)(o,s);const a=(0,S.db)(e,[{field:"absolute_correlation()"},{field:"trend_percentage()"},{field:"trend_difference()"},{field:"count_percentage()"},{field:"tpm()"},{field:"tps()"}],["epm()","eps()"]),i=(0,C.CE)(s),c=(0,C.IO)(s,r,t.project),p=(0,E.Ov)(s);return(0,k.BX)(w.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:C._1}},children:[(0,k.tZ)(Z.h4,{children:(0,k.BX)(Z.oB,{children:[(0,k.tZ)(x.Z,{crumbs:[{label:"Performance",to:this.getPerformanceLink()},{label:"Trends"}]}),(0,k.tZ)(Z.Dx,{children:(0,l.t)("Trends")})]})}),(0,k.tZ)(Z.uT,{children:(0,k.tZ)(Z.or,{fullWidth:!0,children:(0,k.BX)(V,{location:s,eventView:t,projects:r,children:[(0,k.BX)(O,{children:[(0,k.tZ)($,{searchSource:"trends",organization:e,projectIds:o.project,query:p,fields:a,onSearch:this.handleSearch,maxQueryLength:b.dI}),(0,k.tZ)(I,{children:(0,k.tZ)(v.ZP,{buttonProps:{prefix:(0,l.t)("Percentile")},label:i.label,children:C.T1.map((e=>{let{label:t,field:s}=e;return(0,k.tZ)(v.hP,{onSelect:this.handleTrendFunctionChange,eventKey:s,"data-test-id":s,isActive:s===i.field,children:t},s)}))})}),(0,k.tZ)(I,{children:(0,k.tZ)(v.ZP,{buttonProps:{prefix:(0,l.t)("Parameter")},label:c.label,children:C.cs.map((e=>{let{label:t}=e;return(0,k.tZ)(v.hP,{onSelect:this.handleParameterChange,eventKey:t,"data-test-id":t,isActive:t===c.label,children:t},t)}))})})]}),(0,k.BX)(N,{children:[(0,k.tZ)(z.Z,{trendChangeType:F.ER.IMPROVED,previousTrendFunction:n,trendView:o,location:s,setError:this.setError}),(0,k.tZ)(z.Z,{trendChangeType:F.ER.REGRESSION,previousTrendFunction:n,trendView:o,location:s,setError:this.setError})]})]})})})]})}}D.displayName="TrendsContent";class V extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"hasPushedDefaults",!1)}render(){const{children:e,location:t,eventView:s,projects:r}=this.props,n=(0,P.ro)(t.query.query),a=(0,C.IO)(t,r,s.project),i=new q.MY(n||"");if(n||this.hasPushedDefaults)return this.hasPushedDefaults=!0,(0,k.tZ)(o.Fragment,{children:e});this.hasPushedDefaults=!0,i.setFilterValues("tpm()",[">0.01"]),i.setFilterValues(a.column,[">0",`<${C.bg}`]);const l=i.formatString();return s.query=l,g.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:String(l).trim()||void 0}}),null}}V.displayName="DefaultTrends";const $=(0,n.Z)(y.Z,{target:"e1yf76wj3"})("flex-grow:1;margin-bottom:",(0,_.Z)(2),";"),I=(0,n.Z)("div",{target:"e1yf76wj2"})("margin-left:",(0,_.Z)(1),";flex-grow:0;"),O=(0,n.Z)("div",{target:"e1yf76wj1"})({name:"zjik7",styles:"display:flex"}),N=(0,n.Z)("div",{target:"e1yf76wj0"})("display:grid;gap:",(0,_.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){grid-template-columns:repeat(2, minmax(0, 1fr));align-items:stretch;}"),M=(0,u.Z)(D);class B extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{eventView:(0,h.C)(this.props.location,this.props.organization,this.props.projects,{isTrends:!0}),error:void 0}),(0,r.Z)(this,"setError",(e=>{this.setState({error:e})}))}static getDerivedStateFromProps(e,t){return{...t,eventView:(0,h.C)(e.location,e.organization,e.projects,{isTrends:!0})}}getDocumentTitle(){return[(0,l.t)("Trends"),(0,l.t)("Performance")].join(" - ")}renderContent(){const{organization:e,location:t,projects:s}=this.props,{eventView:r}=this.state;return(0,k.tZ)(M,{organization:e,location:t,eventView:r,projects:s})}render(){const{organization:e}=this.props;return(0,k.tZ)(i.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,children:(0,k.tZ)(R,{children:(0,k.tZ)(a.Z,{organization:e,children:this.renderContent()})})})}}B.displayName="TrendsSummary";const L=(0,d.Z)((0,m.Z)((0,u.Z)((0,p.Z)(B)))),R=(0,n.Z)(c.JH,{target:"e183k9ay0"})({name:"1hcx8jb",styles:"padding:0"})}}]);
//# sourceMappingURL=../sourcemaps/app_utils_performance_histogram_utils_tsx-app_views_performance_metricsSwitch_tsx-app_views_p-47deb1.4fc6d6b5f3f606e96910be06a9bb8f00.js.map