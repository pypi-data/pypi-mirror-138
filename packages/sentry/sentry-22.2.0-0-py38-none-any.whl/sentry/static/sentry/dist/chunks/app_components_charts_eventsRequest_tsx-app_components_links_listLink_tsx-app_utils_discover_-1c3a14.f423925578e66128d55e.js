"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_eventsRequest_tsx-app_components_links_listLink_tsx-app_utils_discover_-1c3a14"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{lI:()=>l,eV:()=>d,JE:()=>c}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/lodash/pick.js"),o=s.n(r),a=s("./app/components/charts/utils.tsx"),n=s("./app/utils/getPeriod.tsx"),i=s("./app/utils/performance/constants.tsx");const l=(e,t)=>{var s;let{organization:r,project:o,environment:i,team:l,period:d,start:c,end:u,interval:p,comparisonDelta:m,includePrevious:h,query:v,yAxis:g,field:f,topEvents:x,orderby:y,partial:Z,withoutZerofill:b,referrer:w,queryBatching:D,generatePathname:j,queryExtras:_}=t;const P=(0,a.Sw)(h,d),C={query:{...Object.fromEntries(Object.entries({interval:p,comparisonDelta:m,project:o,environment:i,team:l,query:v,yAxis:g,field:f,topEvents:x,orderby:y,partial:Z?"1":void 0,withoutZerofill:b?"1":void 0,referrer:w||"api.organization-event-stats"}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,n.X)({period:d,start:c,end:u},{shouldDoublePeriod:P}),..._}},k=null!==(s=null==j?void 0:j(r))&&void 0!==s?s:`/organizations/${r.slug}/events-stats/`;return null!=D&&D.batchRequest?D.batchRequest(e,k,C):e.requestPromise(k,C)};async function d(e,t,s){const r={...o()(s,Object.values(i.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:r})}async function c(e,t,s){const r={...o()(s,Object.values(i.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:r}).then((e=>e.count))}},"./app/components/charts/barChartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/react-router/es/index.js"),n=s("./app/components/charts/components/dataZoomInside.tsx"),i=s("./app/components/charts/components/toolBox.tsx"),l=s("./app/utils/callIfFunction.tsx");class d extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"zooming",null),(0,r.Z)(this,"handleChartReady",(e=>{(0,l.g)(this.props.onChartReady,e)})),(0,r.Z)(this,"handleChartFinished",((e,t)=>{var s;"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const r=null===(s=t._componentsViews)||void 0===s?void 0:s.find((e=>e._features&&e._features.dataZoom));r&&!r._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0})})),(0,r.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:r,endValue:o}=s._payload.batch[0];if(null!==r&&null!==o){const{buckets:e,location:s,paramStart:n,paramEnd:i,minZoomWidth:d,onHistoryPush:c}=this.props,{start:u}=e[r],{end:p}=e[o];if(void 0===d||p-u>d){const e={pathname:s.pathname,query:{...s.query,[n]:u,[i]:p}};c?c(u,p):a.browserHistory.push(e)}else t.dispatchAction({type:"restore"}),(0,l.g)(this.props.onDataZoomCancelled)}else t.dispatchAction({type:"restore"}),(0,l.g)(this.props.onDataZoomCancelled);(0,l.g)(this.props.onDataZoom,e,t)}))}render(){const{children:e,xAxisIndex:t}=this.props;return e({onChartReady:this.handleChartReady,onFinished:this.handleChartFinished,dataZoom:(0,n.Z)({xAxisIndex:t}),toolBox:(0,i.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom})}}d.displayName="BarChartZoom";const c=d},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>o}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const r={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function o(e){return e&&Array.isArray(e)?e:[{...r,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function r(e){let{dataZoom:t,...s}=e;return{...t?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo",restore:"reset"},...t}}:{},...s}}function o(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:r(t),...e}}s.d(t,{Z:()=>o}),s("../node_modules/echarts/lib/component/toolbox.js")},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/isEqual.js"),n=s.n(a),i=s("../node_modules/lodash/omitBy.js"),l=s.n(i),d=s("./app/actionCreators/events.tsx"),c=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/charts/loadingPanel.tsx"),p=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("./app/utils/discover/fields.tsx"),v=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const g=["api","children","organization","loading","queryBatching","generatePathname"],f=e=>l()(e,((e,t)=>g.includes(t)));class x extends o.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:s,name:r,hideError:o,...a}=this.props;let n,i=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),s)n=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",r),(0,c.Iw)(n,{append:!0}),this.setState({errored:!0,errorMessage:n});else try{e.clear(),i=await(0,d.lI)(e,a)}catch(e){n=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),o||(0,c.Iw)(n),this.setState({errored:!0,errorMessage:n})}this.unmounting||this.setState({reloading:!1,timeseriesData:i,fetchedWithPrevious:a.includePrevious})}})),(0,r.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:r}=this.props,o=t||(0,p.Sw)(r,s),a=Math.floor(e.length/2);return{current:o?e.slice(a):e,previous:o?e.slice(0,a):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){n()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,s)=>{let[r,o]=e;return{name:t(r,o,s),value:o.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}transformPreviousPeriodData(e,t,s){return t?{seriesName:null!=s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,r)=>1e3*e[r][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{comparisonCount:s}=t;return e+(null!=s?s:0)}),0)}}))}]}processData(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;const{data:o,totals:a}=e,{includeTransformedData:n,includeTimeAggregation:i,timeAggregationSeriesName:l,currentSeriesNames:d,previousSeriesNames:c,comparisonDelta:u}=this.props,{current:m,previous:h}=this.getData(o);return{data:n?this.transformTimeseriesData(m,null!=r?r:null==d?void 0:d[s]):[],comparisonData:n&&u?this.transformComparisonTimeseriesData(m):[],allData:o,originalData:m,totals:a,originalPreviousData:h,previousData:n?this.transformPreviousPeriodData(m,h,null!==(t=r?(0,p.TE)(r):void 0)&&void 0!==t?t:null==c?void 0:c[s]):null,timeAggregatedData:i?this.transformAggregatedTimeseries(m,l||""):{},timeframe:e.start&&e.end?h?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{timeseriesData:r,reloading:o,errored:a,errorMessage:n}=this.state,i=this.props.loading||null===r;if(t&&i)return(0,v.tZ)(u.Z,{"data-test-id":"events-request-loading"});if((0,p.Xe)(r)){let t;const l=Object.keys(r).map(((e,s)=>{const o=r[e],a=this.processData(o,s,(0,h.bQ)(e));return t||(t=a.timeframe),[o.order||0,a.data[0],a.previousData]})).sort(((e,t)=>e[0]-t[0])),d=l.map((e=>e[1])),c=l.some((e=>null===e[2]))?void 0:l.map((e=>e[2]));return e({loading:i,reloading:o,errored:a,errorMessage:n,results:d,timeframe:t,previousTimeseriesData:c,...s})}if(r){const{data:t,comparisonData:l,allData:d,originalData:c,totals:u,originalPreviousData:p,previousData:m,timeAggregatedData:h,timeframe:v}=this.processData(r);return e({loading:i,reloading:o,errored:a,errorMessage:n,timeseriesData:t,comparisonTimeseriesData:l,allTimeseriesData:d,originalTimeseriesData:c,timeseriesTotals:u,originalPreviousTimeseriesData:p,previousTimeseriesData:m?[m]:m,timeAggregatedData:h,timeframe:v,...s})}return e({loading:i,reloading:o,errored:a,errorMessage:n,...s})}}x.displayName="EventsRequest",(0,r.Z)(x,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const y=x},"./app/components/charts/loadingPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/react/index.js"),s("./app/components/loadingMask.tsx")),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,r.Z)((e=>{let{height:t,...s}=e;return(0,a.tZ)("div",{...s,children:(0,a.tZ)(o.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");n.defaultProps={height:"200px"};const i=n},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/react/index.js"),s("./app/components/loadingMask.tsx")),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,r.Z)((e=>{let{className:t,visible:s,children:r,...n}=e;const i=s?{...n,"data-test-id":"loading-placeholder"}:n;return(0,a.tZ)(o.Z,{className:t,...i,children:r})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/links/listLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>h});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-router/es/index.js"),i=s("../node_modules/classnames/index.js"),l=s.n(i),d=s("../node_modules/lodash/omit.js"),c=s.n(d),u=s("../node_modules/query-string/index.js"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m extends a.Component{constructor(){super(...arguments),(0,r.Z)(this,"getClassName",(()=>{const e={},{className:t,activeClassName:s}=this.props;return t&&(e[t]=!0),this.isActive()&&s&&(e[s]=!0),l()(e)}))}isActive(){const{isActive:e,to:t,query:s,index:r,router:o}=this.props,a=s?u.parse(s):void 0,n="string"==typeof t?{pathname:t,query:a}:t;return"function"==typeof e?e(n,r):o.isActive(n,r)}render(){const{index:e,children:t,to:s,disabled:r,...o}=this.props,a=c()(o,"activeClassName","css","isActive","index","router","location");return(0,p.tZ)(v,{className:this.getClassName(),disabled:r,children:(0,p.tZ)(n.Link,{...a,onlyActiveOnIndex:e,to:r?"":s,children:t})})}}m.displayName="ListLink",(0,r.Z)(m,"displayName","ListLink"),(0,r.Z)(m,"defaultProps",{activeClassName:"active",index:!1,disabled:!1});const h=(0,n.withRouter)(m),v=(0,o.Z)("li",{shouldForwardProp:e=>"disabled"!==e,target:"er8tqc10"})((e=>e.disabled&&`\n   a {\n    color:${e.theme.disabled} !important;\n    pointer-events: none;\n    :hover {\n      color: ${e.theme.disabled}  !important;\n    }\n   }\n`),";")},"./app/components/loadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l}),s("../node_modules/react/index.js");var r=s("./app/utils/withApi.tsx"),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,a.tZ)(o.ZP,{route:"eventsv2",shouldRefetchData:n,...e})}i.displayName="DiscoverQuery";const l=(0,r.Z)(i)},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>i}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/moment/moment.js"),o=s.n(r),a=s("./app/constants/index.tsx"),n=s("./app/utils/dates.tsx");function i(e){let{period:t,start:s,end:r}=e,{shouldDoublePeriod:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||s||r||(t=a.GY),t){if(!i)return{statsPeriod:t};const[,e,s]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${s}`}}if(!s||!r)throw new Error("start and end required");const l=(0,n.v5)(s),d=(0,n.v5)(r);if(i){const e=o()(r).diff(o()(s)),t=o()(s).subtract(e);return{start:(0,n.v5)(t),end:d}}return{start:l,end:d}}},"./app/utils/performance/histogram/constants.tsx":(e,t,s)=>{s.d(t,{d:()=>o});var r=s("./app/locale.tsx");const o=[{label:(0,r.t)("Exclude"),value:"exclude_outliers"},{label:(0,r.t)("Include"),value:"all"}]},"./app/utils/performance/histogram/histogramQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/omit.js"),a=s.n(o),n=s("./app/utils/discover/genericDiscoverQuery.tsx"),i=s("./app/utils/withApi.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){const{fields:t,numBuckets:s,min:r,max:o,precision:n,dataFilter:i,eventView:l,location:d}=e,c={field:t,numBuckets:s,min:r,max:o,precision:n,dataFilter:i},u=a()(l.getEventsAPIPayload(d),["field","sort","per_page"]);return Object.assign(c,u)}function c(e){const{children:t,fields:s,didReceiveMultiAxis:o}=e;return 0===s.length?(0,l.tZ)(r.Fragment,{children:t({isLoading:!1,error:null,pageLinks:null,histograms:{}})}):(0,l.tZ)(n.ZP,{route:"events-histogram",getRequestPayload:d,didFetch:function(e){if(o){const t={};Object.entries(e).forEach((e=>{let[s,r]=e;return t[s]=r.length?r.reduce(((e,t)=>e+t.count),0):0})),o(t)}},...a()(e,"children"),children:t=>{let{tableData:s,...r}=t;return e.children({histograms:s,...r})}})}c.displayName="HistogramQuery";const u=(0,i.Z)(c)},"./app/utils/performance/histogram/index.tsx":(e,t,s)=>{s.d(t,{V:()=>d,Z:()=>c});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/react-router/es/index.js"),n=s("./app/utils/queryString.tsx"),i=s("./app/utils/performance/histogram/constants.tsx");class l extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"handleResetView",(()=>{const{location:e,zoomKeys:t}=this.props;a.browserHistory.push({pathname:e.pathname,query:d(e,t)})})),(0,r.Z)(this,"handleFilterChange",(e=>{const{location:t,zoomKeys:s}=this.props;a.browserHistory.push({pathname:t.pathname,query:{...d(t,s),dataFilter:e}})}))}isZoomed(){const{location:e,zoomKeys:t}=this.props;return t.map((t=>e.query[t])).some((e=>void 0!==e))}getActiveFilter(){const{location:e}=this.props,t=e.query.dataFilter?(0,n.ro)(e.query.dataFilter):i.d[0].value;return i.d.find((e=>e.value===t))||i.d[0]}render(){const e={isZoomed:this.isZoomed(),handleResetView:this.handleResetView,activeFilter:this.getActiveFilter(),handleFilterChange:this.handleFilterChange,filterOptions:i.d};return this.props.children(e)}}function d(e,t){const s={...e.query,cursor:void 0};return delete s.dataFilter,t.forEach((e=>delete s[e])),s}l.displayName="Histogram";const c=l},"./app/views/performance/transactionSummary/transactionVitals/constants.tsx":(e,t,s)=>{s.d(t,{sE:()=>n,GW:()=>i,PE:()=>c,QB:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("./app/utils/discover/fields.tsx"),o=s("./app/utils/performance/vitals/constants.tsx"),a=s("./app/utils/theme.tsx");const n=100,i=.75,l=[{vitals:[r.Zl.FP,r.Zl.FCP,r.Zl.LCP],min:0},{vitals:[r.Zl.FID],min:0,precision:2},{vitals:[r.Zl.CLS],min:0,precision:2}],d=[...a.ZP.charts.getColorPalette(l.reduce(((e,t)=>{let{vitals:s}=t;return e+s.length}),0)-1)].reverse(),c=l.map((e=>({...e,colors:d.splice(0,e.vitals.length)}))),u=l.reduce(((e,t)=>{let{vitals:s}=t;return s.forEach((t=>{const s=o.r9[t].slug;e.push(`${s}Start`),e.push(`${s}End`)})),e}),[])},"./app/views/performance/transactionSummary/transactionVitals/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>ye}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("./app/locale.tsx"),o=s("./app/utils/discover/eventView.tsx"),a=s("./app/utils/discover/fields.tsx"),n=s("./app/utils/performance/vitals/constants.tsx"),i=s("./app/utils/queryString.tsx"),l=s("./app/utils/tokenizeSearch.tsx"),d=s("./app/utils/withOrganization.tsx"),c=s("./app/utils/withProjects.tsx"),u=s("./app/views/performance/transactionSummary/pageLayout.tsx"),p=s("./app/views/performance/transactionSummary/tabs.tsx"),m=s("./app/views/performance/transactionSummary/transactionVitals/constants.tsx"),h=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),v=s("../node_modules/react/index.js"),g=s("../node_modules/react-router/es/index.js"),f=s("./app/components/alert.tsx"),x=s("./app/components/button.tsx"),y=s("./app/components/dropdownControl.tsx"),Z=s("./app/components/events/searchBar.tsx"),b=s("./app/components/layouts/thirds.tsx"),w=s("./app/components/links/externalLink.tsx"),D=s("./app/components/organizations/pageFilters/parse.tsx"),j=s("./app/icons/index.tsx"),_=s("./app/styles/space.tsx"),P=s("./app/utils/analytics.tsx"),C=s("./app/utils/performance/histogram/index.tsx"),k=s("./app/utils/performance/histogram/constants.tsx"),S=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),z=s("./app/components/panels/index.tsx"),q=s("./app/utils/performance/histogram/histogramQuery.tsx"),V=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),F=s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),N=s("../node_modules/lodash/isEqual.js"),T=s.n(N),E=s("../node_modules/lodash/throttle.js"),R=s.n(E),A=s("./app/components/charts/barChart.tsx"),L=s("./app/components/charts/barChartZoom.tsx"),M=s("./app/components/charts/components/markLine.tsx"),O=s("./app/components/charts/transparentLoadingMask.tsx"),$=s("./app/components/placeholder.tsx"),B=s("./app/utils/formatters.tsx"),I=s("./app/utils/getDynamicText.tsx"),W=s("./app/utils/performance/histogram/utils.tsx"),Q=s("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),H=s("./app/views/performance/landing/vitalsCards.tsx"),G=s("./app/views/performance/vitalDetail/utils.tsx"),K=s("./app/components/charts/styles.tsx");const X=(0,h.Z)(z.Lv,{target:"e1l3pu0z5"})({name:"1slq3zi",styles:"display:grid;grid-template-columns:325px minmax(100px, auto);padding:0"}),J=(0,h.Z)("div",{target:"e1l3pu0z4"})("padding:",(0,_.Z)(3),";"),U=(0,h.Z)(J,{target:"e1l3pu0z3"})("position:relative;border-right:1px solid ",(e=>e.theme.border),";grid-column:1/1;display:flex;flex-direction:column;justify-content:space-between;"),Y=(0,h.Z)(K.OT,{target:"e1l3pu0z2"})({name:"cfjpzu",styles:"margin:0px"}),ee=(0,h.Z)("div",{target:"e1l3pu0z1"})("font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";"),te=(0,h.Z)("div",{target:"e1l3pu0z0"})({name:"5r9nha",styles:"font-size:32px"});var se=s("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),re=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class oe extends v.Component{constructor(){super(...arguments),(0,V.Z)(this,"state",{refDataRect:null,refPixelRect:null}),(0,V.Z)(this,"trackOpenInDiscoverClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,P.ec)({eventKey:"performance_views.vitals.open_in_discover",eventName:"Performance Views: Open vitals in discover",organization_id:e.id,vital:t.slug})})),(0,V.Z)(this,"trackOpenAllEventsClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,P.ec)({eventKey:"performance_views.vitals.open_all_events",eventName:"Performance Views: Open vitals in all events",organization_id:e.id,vital:t.slug})})),(0,V.Z)(this,"handleRendered",R()(((e,t)=>{const{chartData:s}=this.props,{refDataRect:r}=this.state;if(null===r||s.length<1)return;const o=null===r?null:(0,se.L0)(t,r);null===o||T()(o,this.state.refPixelRect)||this.setState({refPixelRect:o})}),200,{leading:!0})),(0,V.Z)(this,"handleDataZoomCancelled",(()=>{}))}static getDerivedStateFromProps(e,t){const{isLoading:s,error:r,chartData:o}=e;if(s||null===r)return{...t};const a=(0,se.eH)(o);return null===t.refDataRect||null!==a&&!T()(a,t.refDataRect)?{...t,refDataRect:a}:{...t}}get summary(){var e;const{summaryData:t}=this.props;return null!==(e=null==t?void 0:t.p75)&&void 0!==e?e:null}get failureRate(){var e,t;const{summaryData:s}=this.props,r=null!==(e=null==s?void 0:s.poor)&&void 0!==e?e:0,o=null!==(t=null==s?void 0:s.total)&&void 0!==t?t:0;return o<=0?0:r/o}getFormattedStatNumber(){const{vitalDetails:e}=this.props,t=this.summary,{type:s}=e;return null===t?"—":"duration"===s?(0,B.g9)(t/1e3,2,!0):(0,B.$1)(t,2)}renderSummary(){var e;const{vitalDetails:t,eventView:s,organization:o,min:n,max:i,dataFilter:d}=this.props,{slug:c,name:u,description:p}=t,h=`measurements.${c}`,v=s.withColumns([{kind:"field",field:"transaction"},{kind:"function",function:["percentile",h,m.GW.toString(),void 0]},{kind:"function",function:["count","","",void 0]}]).withSorts([{kind:"desc",field:(0,a.LY)(`percentile(${h},${m.GW.toString()})`)}]),g=new l.MY(null!==(e=v.query)&&void 0!==e?e:"");return g.addFilterValues("has",[h]),void 0===n&&void 0===i||(void 0!==n&&g.addFilterValues(h,[`>=${n}`]),void 0!==i&&g.addFilterValues(h,[`<=${i}`])),v.query=g.formatString(),(0,re.BX)(U,{children:[(0,re.tZ)(ae,{children:(0,re.tZ)(Y,{children:`${u} (${c.toUpperCase()})`})}),(0,re.tZ)(te,{children:(0,I.Z)({value:this.getFormattedStatNumber(),fixed:"—"})}),(0,re.tZ)(ee,{children:p}),(0,re.tZ)("div",{children:(0,re.tZ)(x.ZP,{size:"xsmall",to:v.withColumns([{kind:"field",field:h}]).withSorts([{kind:"desc",field:h}]).getPerformanceTransactionEventsViewUrlTarget(o.slug,{showTransactions:"all"===d?Q.q3.p100:Q.q3.p75,webVital:h}),onClick:this.trackOpenAllEventsClicked,children:(0,r.t)("View All Events")})})]})}renderHistogram(){const{theme:e,location:t,isLoading:s,chartData:r,summaryData:o,error:a,colors:n,vital:i,vitalDetails:l,precision:d=0}=this.props,{slug:c}=l,u=this.getSeries(),p={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},h=u.data.map((e=>e.value)),v={type:"value",max:h.length?Math.max(...h):void 0,axisLabel:{color:e.chartLabel,formatter:B.Du}},g=[u];if(!s&&!a){const e=this.getBaselineSeries();null!==e&&g.push(e)}const f=s||a||null===o?{}:{[i]:o};return(0,re.tZ)(L.Z,{minZoomWidth:10**-d*m.sE,location:t,paramStart:`${c}Start`,paramEnd:`${c}End`,xAxisIndex:[0],buckets:(0,W._W)(r),onDataZoomCancelled:this.handleDataZoomCancelled,children:e=>(0,re.BX)(ne,{children:[(0,re.tZ)(O.Z,{visible:s}),(0,re.tZ)(ie,{children:(0,re.tZ)(H.JO,{isLoading:s,data:f,vital:i,showBar:!1,showStates:!1,showVitalPercentNames:!1,showDurationDetail:!1})}),(0,I.Z)({value:(0,re.tZ)(A.Z,{series:g,xAxis:p,yAxis:v,colors:n,onRendered:this.handleRendered,grid:{left:(0,_.Z)(3),right:(0,_.Z)(3),top:(0,_.Z)(3),bottom:(0,_.Z)(1.5)},stacked:!0,...e}),fixed:(0,re.tZ)($.Z,{testId:"skeleton-ui",height:"200px"})})]})})}bucketWidth(){const{chartData:e}=this.props;return e.length>=2?e[1].bin-e[0].bin:0}getSeries(){const{theme:e,chartData:t,precision:s,vitalDetails:o,vital:a}=this.props,n=(0,W.GT)(t,{precision:0===s?void 0:s,type:o.type,additionalFieldsFn:t=>({itemStyle:{color:e[this.getVitalsColor(a,t)]}})});return{seriesName:(0,r.t)("Count"),data:n}}getVitalsColor(e,t){const s=G.eE[e],r=G.MN[e];return t>=s?G.fL[G.SP.POOR]:t>=r?G.fL[G.SP.MEH]:G.fL[G.SP.GOOD]}getBaselineSeries(){const{theme:e,chartData:t}=this.props,s=this.summary;if(null===s||null===this.state.refPixelRect)return null;const o=(0,se.oZ)(t,s);if(null===o||-1===o)return null;const a=(0,se.jb)({x:o-.5,y:0},this.state.refDataRect,this.state.refPixelRect);if(null===a)return null;const n=(0,se.jb)({x:o-.5,y:Math.max(...t.map((e=>e.count)))||1},this.state.refDataRect,this.state.refPixelRect);if(null===n)return null;const i=(0,M.Z)({animationDuration:200,data:[[a,n]],label:{show:!1},lineStyle:{color:e.textColor,type:"solid"},tooltip:{formatter:()=>['<div class="tooltip-series tooltip-series-solo">','<span class="tooltip-label">',`<strong>${(0,r.t)("p75")}</strong>`,"</span>","</div>",'<div class="tooltip-arrow"></div>'].join("")}});return{seriesName:(0,r.t)("p75"),data:[],markLine:i}}render(){return(0,re.BX)(X,{children:[this.renderSummary(),this.renderHistogram()]})}}oe.displayName="VitalCard";const ae=(0,h.Z)("div",{target:"e1yeyzg42"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),ne=(0,h.Z)("div",{target:"e1yeyzg41"})({name:"bjn8wh",styles:"position:relative"}),ie=(0,h.Z)("div",{target:"e1yeyzg40"})("position:absolute;top:",(0,_.Z)(2),";right:",(0,_.Z)(3),";z-index:2;"),le=(0,F.b)(oe);class de extends v.Component{renderVitalCard(e,t,s,r,o,a,i,l,d){const{location:c,organization:u,eventView:p,dataFilter:h}=this.props,v=n.r9[e],g=void 0!==i||void 0!==l;return(0,re.tZ)(q.Z,{location:c,orgSlug:u.slug,eventView:p,numBuckets:m.sE,fields:g?[e]:[],min:i,max:l,precision:d,dataFilter:h,children:n=>{var m,f;const x=g?n.isLoading:t,y=g?null!==n.error:s,Z=g&&null!==(m=null===(f=n.histograms)||void 0===f?void 0:f[e])&&void 0!==m?m:o;return(0,re.tZ)(le,{location:c,isLoading:x,error:y,vital:e,vitalDetails:v,summaryData:r,chartData:Z,colors:a,eventView:p,organization:u,min:i,max:l,precision:d,dataFilter:h})}})}renderVitalGroup(e,t){const{location:s,organization:r,eventView:o,dataFilter:a}=this.props,{vitals:l,colors:d,min:c,max:u,precision:p}=e,h=l.reduce(((e,t)=>{const r=n.r9[t].slug;return e[t]={start:(0,i.ro)(s.query[`${r}Start`]),end:(0,i.ro)(s.query[`${r}End`])},e}),{});return(0,re.tZ)(q.Z,{location:s,orgSlug:r.slug,eventView:o,numBuckets:m.sE,fields:l,min:c,max:u,precision:p,dataFilter:a,children:e=>{const s=t.isLoading||e.isLoading,r=null!==t.error||null!==e.error;return(0,re.tZ)(v.Fragment,{children:l.map(((o,a)=>{var n,i,l,c,u;const m=null!==(n=null==t||null===(i=t.vitalsData)||void 0===i?void 0:i[o])&&void 0!==n?n:null,g=null!==(l=null===(c=e.histograms)||void 0===c?void 0:c[o])&&void 0!==l?l:[],{start:f,end:x}=null!==(u=h[o])&&void 0!==u?u:{};return(0,re.tZ)(v.Fragment,{children:this.renderVitalCard(o,s,r,m,g,[d[a]],ce(f,p),ce(x,p),p)},o)}))})}})}render(){const{results:e}=this.props;return(0,re.tZ)(z.s_,{children:(0,re.tZ)(v.Fragment,{children:m.PE.map((t=>(0,re.tZ)(v.Fragment,{children:this.renderVitalGroup(t,e)},t.vitals.join(""))))})})}}function ce(e,t){if(void 0!==e)return void 0===t||0===t?parseInt(e,10):parseFloat(e)}de.displayName="VitalsPanel";const ue=de;function pe(e){const{location:t,organization:s,eventView:o}=e,a=(0,i.ro)(t.query.query,""),n=e=>{const s=(0,D.fK)({...t.query||{},query:e});delete s.cursor,g.browserHistory.push({pathname:t.pathname,query:s})},l=m.PE.reduce(((e,t)=>{let{vitals:s}=t;return e.concat(s)}),[]);return(0,re.tZ)(C.Z,{location:t,zoomKeys:m.QB,children:e=>{let{activeFilter:i,handleFilterChange:d,handleResetView:c,isZoomed:u}=e;return(0,re.tZ)(b.or,{fullWidth:!0,children:(0,re.tZ)(S.Z,{eventView:o,orgSlug:s.slug,location:t,vitals:l,children:e=>{const p=!e.isLoading&&l.some((t=>{var s;return!(null!==(s=e.vitalsData)&&void 0!==s&&s[t])}));return(0,re.BX)(v.Fragment,{children:[p&&(0,re.tZ)(f.Z,{type:"info",icon:(0,re.tZ)(j.aU,{size:"md"}),children:(0,r._N)("If this page is looking a little bare, keep in mind not all browsers support these vitals. [link]",{link:(0,re.tZ)(w.Z,{href:"https://docs.sentry.io/product/performance/web-vitals/#browser-support",children:(0,r.t)("Read more about browser support.")})})}),(0,re.BX)(he,{children:[(0,re.tZ)(me,{organization:s,projectIds:o.project,query:a,fields:o.fields,onSearch:n}),(0,re.tZ)(y.ZP,{buttonProps:{prefix:(0,r.t)("Outliers")},label:i.label,children:k.d.map((e=>{let{label:t,value:r}=e;return(0,re.tZ)(y.hP,{onSelect:e=>{(0,P.ec)({eventKey:"performance_views.vitals.filter_changed",eventName:"Performance Views: Change vitals filter",organization_id:s.id,value:e}),d(e)},eventKey:r,isActive:r===i.value,children:t},r)}))}),(0,re.tZ)(x.ZP,{onClick:()=>{(0,P.ec)({eventKey:"performance_views.vitals.reset_view",eventName:"Performance Views: Reset vitals view",organization_id:s.id}),c()},disabled:!u,"data-test-id":"reset-view",children:(0,r.t)("Reset View")})]}),(0,re.tZ)(ue,{organization:s,location:t,eventView:o,dataFilter:i.value,results:e})]})}})})}})}pe.displayName="VitalsContent";const me=(0,h.Z)(Z.Z,{target:"ekvr84z1"})({name:"1ff36h2",styles:"flex-grow:1"}),he=(0,h.Z)("div",{target:"ekvr84z0"})("display:grid;gap:",(0,_.Z)(2),";grid-template-columns:auto max-content max-content;align-items:center;margin-bottom:",(0,_.Z)(3),";"),ve=pe;function ge(e){const{location:t,organization:s,projects:r}=e;return(0,re.tZ)(u.Z,{location:t,organization:s,projects:r,tab:p.Z.WebVitals,getDocumentTitle:fe,generateEventView:xe,childComponent:ve})}function fe(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,r.t)("Vitals")].join(" — "):[(0,r.t)("Summary"),(0,r.t)("Vitals")].join(" — ")}function xe(e){let{location:t,transactionName:s,isMetricsData:r}=e;const d=(0,i.ro)(t.query.query,""),c=new l.MY(d);r||c.setFilterValues("event.type",["transaction"]).setFilterValues("transaction.op",["pageload"]),c.setFilterValues("transaction",[s]),Object.keys(c.filters).forEach((e=>{(0,a.h1)(e)&&c.removeFilter(e)}));const u=m.PE.reduce(((e,t)=>e.concat(t.vitals)),[]);return o.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:s,fields:[...u.map((e=>`percentile(${e}, ${m.GW})`)),...u.map((e=>`count_at_least(${e}, 0)`)),...u.map((e=>`count_at_least(${e}, ${n.r9[e].poorThreshold})`))],query:c.formatString(),projects:[]},t)}ge.displayName="TransactionVitals";const ye=(0,c.Z)((0,d.Z)(ge))}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsRequest_tsx-app_components_links_listLink_tsx-app_utils_discover_-1c3a14.57462b3619b6883456f2aee41356e0df.js.map