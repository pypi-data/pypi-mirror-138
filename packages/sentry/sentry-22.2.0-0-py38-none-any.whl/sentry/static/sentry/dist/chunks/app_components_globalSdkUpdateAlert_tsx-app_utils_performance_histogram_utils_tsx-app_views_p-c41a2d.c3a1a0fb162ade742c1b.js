"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_globalSdkUpdateAlert_tsx-app_utils_performance_histogram_utils_tsx-app_views_p-c41a2d"],{"./app/components/globalSdkUpdateAlert.tsx":(t,e,s)=>{s.d(e,{Z:()=>z});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/actionCreators/prompts.tsx"),a=s("./app/actions/sidebarPanelActions.tsx"),l=s("./app/components/alert.tsx"),p=s("./app/constants/pageFilters.tsx"),d=s("./app/icons/index.tsx"),c=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),h=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),m=s("./app/utils/promptIsDismissed.tsx"),g=s("./app/utils/withApi.tsx"),f=s("./app/utils/withOrganization.tsx"),x=s("./app/utils/withPageFilters.tsx"),v=s("./app/utils/withSdkUpdates.tsx"),y=s("./app/components/sidebar/types.tsx"),b=s("./app/components/button.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{isDismissed:null}),(0,n.Z)(this,"snoozePrompt",(()=>{const{api:t,organization:e}=this.props;(0,r.Xt)(t,{organizationId:e.id,feature:"sdk_updates",status:"snoozed"}),this.setState({isDismissed:!0}),(t=>{let{organization:e}=t;(0,h.Z)("sdk_updates.snoozed",{organization:e})})({organization:this.props.organization})}))}componentDidMount(){this.promptsCheck(),(t=>{let{organization:e}=t;(0,h.Z)("sdk_updates.seen",{organization:e})})({organization:this.props.organization})}async promptsCheck(){const{api:t,organization:e}=this.props,s=await(0,r.vu)(t,{organizationId:e.id,feature:"sdk_updates"});this.setState({isDismissed:(0,m.I)(s)})}render(){const{api:t,selection:e,sdkUpdates:s,organization:n,Wrapper:o,...i}=this.props,{isDismissed:r}=this.state;if(!s||null===r||r)return null;if(0===(u=0===(null==e?void 0:e.projects.length)||(null==e?void 0:e.projects)===[p.mP]?s:s.filter((t=>{var s;return null==e||null===(s=e.projects)||void 0===s?void 0:s.includes(parseInt(t.projectId,10))})),u.reduce(((t,e)=>[...t,...e.suggestions]),[])).length)return null;var u;const m=(0,Z.tZ)(b.ZP,{priority:"link",size:"zero",onClick:()=>{a.Z.activatePanel(y.z.Broadcasts),(t=>{let{organization:e}=t;(0,h.Z)("sdk_updates.clicked",{organization:e})})({organization:n})},children:(0,c.t)("Review updates")}),g=(0,Z.tZ)(l.Z,{type:"info",icon:(0,Z.tZ)(d.XK,{}),...i,children:(0,Z.BX)(w,{children:[(0,c.t)("You have outdated SDKs in your projects. Update them for important fixes and features."),(0,Z.BX)(S,{children:[(0,Z.tZ)(b.ZP,{priority:"link",size:"zero",title:(0,c.t)("Dismiss for the next two weeks"),onClick:this.snoozePrompt,children:(0,c.t)("Remind me later")}),"|",m]})]})});return o?(0,Z.tZ)(o,{children:g}):g}}j.displayName="InnerGlobalSdkSuggestions";const w=(0,o.Z)("div",{target:"e13jrk6t1"})("display:flex;flex-wrap:wrap;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){justify-content:space-between;}"),S=(0,o.Z)("div",{target:"e13jrk6t0"})("display:grid;grid-template-columns:repeat(3, max-content);gap:",(0,u.Z)(1),";"),z=(0,f.Z)((0,v.Z)((0,x.Z)((0,g.Z)(j))))},"./app/utils/performance/histogram/utils.tsx":(t,e,s)=>{s.d(e,{te:()=>o,_W:()=>i,GT:()=>r});var n=s("./app/utils/formatters.tsx");function o(t){return t.length>=2?t[1].bin-t[0].bin:0}function i(t){const e=o(t);return t.map((t=>{const s=t.bin;return{start:s,end:s+e}}))}function r(t){let{precision:e,type:s,additionalFieldsFn:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t=>{switch(s){case"duration":const o=null!=e?e:t<1e3?0:3;return(0,n.g9)(t/1e3,o,!0);case"number":const i=10**(null!=e?e:0);return(Math.round((t+Number.EPSILON)*i)/i).toLocaleString();default:throw new Error(`Unable to format type: ${s}`)}};return t.map((t=>{var e;return{value:t.count,name:i(t.bin),...null!==(e=null==o?void 0:o(t.bin))&&void 0!==e?e:{}}}))}},"./app/views/performance/metricsSwitch.tsx":(t,e,s)=>{s.d(e,{BR:()=>h,z5:()=>f,_4:()=>x,j9:()=>g});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/components/acl/feature.tsx"),r=s("./app/components/switchButton.tsx"),a=s("./app/locale.tsx"),l=s("./app/styles/space.tsx"),p=s("./app/utils/localStorage.tsx"),d=s("./app/utils/useOrganization.tsx"),c=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u="metrics-performance-ui";function h(t){let{onSwitch:e}=t;const s=(0,d.Z)(),{isMetricsData:n,setIsMetricsData:o}=x();return(0,c.tZ)(i.Z,{features:[u],organization:s,children:(0,c.BX)(m,{children:[(0,a.t)("Metrics Data"),(0,c.tZ)(r.Z,{isActive:n,toggle:function(){e(),o(!n)},size:"lg"})]})})}h.displayName="MetricsSwitch";const m=(0,n.Z)("label",{target:"euzi8um0"})("display:flex;align-items:center;justify-content:center;margin-bottom:0;gap:",(0,l.Z)(1),";font-weight:normal;"),g=(0,o.createContext)({isMetricsData:!1,setIsMetricsData:t=>{}});function f(t){let{children:e}=t;const s=(0,d.Z)(),n=`metrics.performance:${s.slug}`,[i,r]=(0,o.useState)("true"===p.Z.getItem(n));return(0,c.tZ)(g.Provider,{value:{isMetricsData:i&&s.features.includes(u),setIsMetricsData:function(t){p.Z.setItem(n,t.toString()),r(t)}},children:e})}function x(){return(0,o.useContext)(g)}f.displayName="MetricsSwitchContextContainer"},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(t,e,s)=>{s.d(e,{q3:()=>a,_S:()=>l,xr:()=>p,tb:()=>d,qg:()=>c,Zq:()=>u});var n=s("./app/locale.tsx"),o=s("./app/utils/queryString.tsx"),i=s("./app/views/performance/transactionSummary/filter.tsx"),r=s("./app/views/performance/transactionSummary/utils.tsx");let a;function l(t,e){const{p99:s,p95:o,p75:r,p50:l}=e||{p99:0,p95:0,p75:0,p50:0};return{[a.p50]:{name:a.p50,query:l?[["transaction.duration",`<=${l.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,i.T$)(t)||"transaction.duration"},label:(0,n.t)("p50")},[a.p75]:{name:a.p75,query:r?[["transaction.duration",`<=${r.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,i.T$)(t)||"transaction.duration"},label:(0,n.t)("p75")},[a.p95]:{name:a.p95,query:o?[["transaction.duration",`<=${o.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,i.T$)(t)||"transaction.duration"},label:(0,n.t)("p95")},[a.p99]:{name:a.p99,query:s?[["transaction.duration",`<=${s.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,i.T$)(t)||"transaction.duration"},label:(0,n.t)("p99")},[a.p100]:{name:a.p100,label:(0,n.t)("p100")}}}function p(t){let{orgSlug:e,transaction:s,projectID:n,query:o}=t;return{pathname:`/organizations/${e}/performance/summary/events/`,query:{transaction:s,project:n,environment:o.environment,statsPeriod:o.statsPeriod,start:o.start,end:o.end,query:o.query}}}function d(t){return e=(0,o.ro)(t.query.showTransactions,a.p100),Object.values(a).includes(e)?e:a.p100;var e}function c(t,e){var s,n;const o=l(e),i=null===(s=o[t].sort)||void 0===s?void 0:s.kind,r=null===(n=o[t].sort)||void 0===n?void 0:n.field,a={showTransactions:t};return i&&r&&(a.sort=`${"desc"===i?"-":""}${r}`),a}function u(t){switch(t){case r.K0.OUTLIER:return a.p100;case r.K0.SLOW:return a.p95;default:return}}!function(t){t.p50="p50",t.p75="p75",t.p95="p95",t.p99="p99",t.p100="p100"}(a||(a={}))},"./app/views/performance/transactionSummary/transactionThresholdModal.tsx":(t,e,s)=>{s.d(e,{fY:()=>k,ZP:()=>C});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("../node_modules/lodash/cloneDeep.js"),a=s.n(r),l=s("../node_modules/lodash/set.js"),p=s.n(l),d=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/button.tsx"),u=s("./app/components/buttonBar.tsx"),h=s("./app/components/forms/controls/input.tsx"),m=s("./app/components/forms/field/index.tsx"),g=s("./app/components/forms/selectControl.tsx"),f=s("./app/components/links/link.tsx"),x=s("./app/locale.tsx"),v=s("./app/styles/space.tsx"),y=s("./app/utils.tsx"),b=s("./app/utils/withApi.tsx"),Z=s("./app/utils/withProjects.tsx"),j=s("./app/views/performance/transactionSummary/utils.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let S;!function(t){t.TRANSACTION_DURATION="duration",t.LARGEST_CONTENTFUL_PAINT="lcp"}(S||(S={}));const z=[{label:(0,x.t)("Transaction Duration"),value:"duration"},{label:(0,x.t)("Largest Contentful Paint"),value:"lcp"}];class _ extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{threshold:this.props.transactionThreshold,metric:this.props.transactionThresholdMetric,error:null}),(0,n.Z)(this,"handleApply",(async t=>{t.preventDefault();const{api:e,closeModal:s,organization:n,transactionName:o,onApply:i}=this.props,r=this.getProject();if(!(0,y.ri)(r))return;const a=`/organizations/${n.slug}/project-transaction-threshold-override/`;e.requestPromise(a,{method:"POST",includeAllArgs:!0,query:{project:r.id},data:{transaction:o,threshold:this.state.threshold,metric:this.state.metric}}).then((()=>{s(),i&&i(this.state.threshold,this.state.metric)})).catch((t=>{var e,s,n,o;this.setState({error:t});const i=null!==(e=null!==(s=null===(n=t.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==s?s:null===(o=t.responseJSON)||void 0===o?void 0:o.non_field_errors)&&void 0!==e?e:null;(0,d.Iw)(i)}))})),(0,n.Z)(this,"handleFieldChange",(t=>e=>{this.setState((s=>{const n=a()(s);return p()(n,t,e),{...n,errors:void 0}}))})),(0,n.Z)(this,"handleReset",(async t=>{t.preventDefault();const{api:e,closeModal:s,organization:n,transactionName:o,onApply:i}=this.props,r=this.getProject();if(!(0,y.ri)(r))return;const a=`/organizations/${n.slug}/project-transaction-threshold-override/`;e.requestPromise(a,{method:"DELETE",includeAllArgs:!0,query:{project:r.id},data:{transaction:o}}).then((()=>{const t=`/projects/${n.slug}/${r.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{project:r.id}}).then((t=>{let[e]=t;this.setState({threshold:e.threshold,metric:e.metric}),s(),i&&i(this.state.threshold,this.state.metric)})).catch((t=>{var e,s;const n=null!==(e=null===(s=t.responseJSON)||void 0===s?void 0:s.threshold)&&void 0!==e?e:null;(0,d.Iw)(n)}))})).catch((t=>{this.setState({error:t})}))}))}getProject(){const{projects:t,eventView:e,project:s}=this.props;if((0,y.ri)(s))return t.find((t=>t.id===s));const n=String(e.project[0]);return t.find((t=>t.id===n))}renderModalFields(){return(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(m.Z,{"data-test-id":"response-metric",label:(0,x.t)("Calculation Method"),inline:!1,help:(0,x.t)("This determines which duration metric is used for the Response Time Threshold."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,w.tZ)(g.Z,{required:!0,options:z.slice(),name:"responseMetric",label:(0,x.t)("Calculation Method"),value:this.state.metric,onChange:t=>{this.handleFieldChange("metric")(t.value)}})}),(0,w.tZ)(m.Z,{"data-test-id":"response-time-threshold",label:(0,x.t)("Response Time Threshold (ms)"),inline:!1,help:(0,x.t)("The satisfactory response time for the calculation method defined above. This is used to calculate Apdex and User Misery scores."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,w.tZ)(h.Z,{type:"number",name:"threshold",required:!0,pattern:"[0-9]*(\\.[0-9]*)?",onChange:t=>{this.handleFieldChange("threshold")(t.target.value)},value:this.state.threshold,step:100,min:100})})]})}render(){const{Header:t,Body:e,Footer:s,organization:n,transactionName:o,eventView:r}=this.props,a=this.getProject(),l=r.clone();l.query=l.getQueryWithAdditionalConditions();const p=(0,j.e1)({orgSlug:n.slug,transaction:o,query:l.generateQueryStringObject(),projectID:null==a?void 0:a.id});return(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(t,{closeButton:!0,children:(0,w.tZ)("h4",{children:(0,x.t)("Transaction Settings")})}),(0,w.BX)(e,{children:[(0,w.tZ)(T,{children:(0,x._N)("The changes below will only be applied to [transaction]. To set it at a more global level, go to [projectSettings: Project Settings].",{transaction:(0,w.tZ)(f.Z,{to:p,children:o}),projectSettings:(0,w.tZ)(f.Z,{to:`/settings/${n.slug}/projects/${null==a?void 0:a.slug}/performance/`})})}),this.renderModalFields()]}),(0,w.tZ)(s,{children:(0,w.BX)(u.ZP,{gap:1,children:[(0,w.tZ)(c.ZP,{priority:"default",onClick:this.handleReset,"data-test-id":"reset-all",children:(0,x.t)("Reset All")}),(0,w.tZ)(c.ZP,{"aria-label":(0,x.t)("Apply"),priority:"primary",onClick:this.handleApply,"data-test-id":"apply-threshold",children:(0,x.t)("Apply")})]})})]})}}_.displayName="TransactionThresholdModal";const T=(0,o.Z)("div",{target:"ezg6l150"})("margin-bottom:",(0,v.Z)(4),";"),k={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},C=(0,b.Z)((0,Z.Z)(_))}}]);
//# sourceMappingURL=../sourcemaps/app_components_globalSdkUpdateAlert_tsx-app_utils_performance_histogram_utils_tsx-app_views_p-c41a2d.88b691f9eac8d3365daae53a9619fdfd.js.map