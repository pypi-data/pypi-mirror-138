"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_alerts_incidentRules_presets_tsx-app_views_alerts_utils_index_tsx"],{"./app/utils/discover/charts.tsx":(t,e,r)=>{r.d(e,{CX:()=>o,gu:()=>u});var n=r("./app/locale.tsx"),a=r("./app/utils.tsx"),s=r("./app/utils/discover/fields.tsx"),i=r("./app/utils/formatters.tsx");function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(0,a.ri)(t))return"—";switch((0,s.Px)(e)){case"integer":case"number":return t.toLocaleString();case"percentage":return(0,i.rl)(t,2);case"duration":return(0,i.g9)(t/1e3,2,!0);default:return t.toString()}}function u(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch((0,s.Px)(e)){case"integer":case"number":return r?(0,i.Du)(t):t.toLocaleString();case"percentage":return(0,i.rl)(t,0);case"duration":return l(t);default:return t.toString()}}function l(t){if(0===t)return"0";if(t>=i.ps){const e=(t/i.ps).toFixed(0);return(0,n.t)("%swk",e)}if(t>=i.x4){const e=(t/i.x4).toFixed(0);return(0,n.t)("%sd",e)}if(t>=i.kr){const e=(t/i.kr).toFixed(0);return(0,n.t)("%shr",e)}if(t>=i.EB){const e=(t/i.EB).toFixed(0);return(0,n.t)("%smin",e)}if(t>=i.sh){const e=(t/i.sh).toFixed(0);return(0,n.t)("%ss",e)}const e=t.toFixed(0);return(0,n.t)("%sms",e)}},"./app/views/alerts/incidentRules/presets.tsx":(t,e,r)=>{r.d(e,{g:()=>p}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("./app/locale.tsx"),a=r("./app/utils/discover/types.tsx"),s=r("./app/utils/tokenizeSearch.tsx"),i=r("./app/views/alerts/utils/index.tsx"),o=r("./app/utils/discover/eventView.tsx"),u=r("./app/utils/discover/fields.tsx"),l=r("./app/views/alerts/incidentRules/types.tsx");function c(t){var e;const{orgSlug:r,projects:n,incident:a,stats:s,extraQueryParams:c}=t;if(!(n&&n.length&&a&&s))return"";const d=`${a.alertRule.timeWindow}m`,{start:p,end:R}=(0,i.Eq)(s),S={id:void 0,name:a&&a.title||"",orderby:`-${(0,u.LY)(a.alertRule.aggregate)}`,yAxis:a.alertRule.aggregate?[a.alertRule.aggregate]:void 0,query:null!==(e=null==a?void 0:a.discoverQuery)&&void 0!==e?e:"",projects:n.filter((t=>{let{slug:e}=t;return a.projects.includes(e)})).map((t=>{let{id:e}=t;return Number(e)})),version:2,fields:a.alertRule.dataset===l.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.alertRule.aggregate],start:p,end:R,...c},E=o.ZP.fromSavedQuery(S),{query:T,...v}=E.getResultsViewUrlTarget(r);return{query:{...T,interval:d},...v}}var d=r("./app/views/performance/transactionSummary/utils.tsx");const p=[{name:(0,n.t)("Error count"),match:/^count\(\)/,validDataset:[l.qz.ERRORS],default:"count()",makeCtaParams:S},{name:(0,n.t)("Users affected"),match:/^count_unique\(user\)/,validDataset:[l.qz.ERRORS],default:"count_unique(user)",makeCtaParams:S},{name:(0,n.t)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[l.qz.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:t=>R({opts:t,tooltip:(0,n.t)("Latency by Transaction")})},{name:(0,n.t)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[l.qz.TRANSACTIONS],default:"apdex(300)",makeCtaParams:t=>R({opts:t,tooltip:(0,n.t)("Apdex by Transaction")})},{name:(0,n.t)("Transaction Count"),match:/^count\(\)/,validDataset:[l.qz.TRANSACTIONS],default:"count()",makeCtaParams:t=>R({opts:t})},{name:(0,n.t)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[l.qz.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function(t){var e,r;let{orgSlug:i,incident:o,projects:u,stats:l}=t;if(!o||!l)return{to:"",buttonText:(0,n.t)("Incident details")};const d=null===(r=new s.MY(null!==(e=o.discoverQuery)&&void 0!==e?e:"").getFilterValues("transaction"))||void 0===r?void 0:r.find((t=>!t.includes("*")));return{to:c({orgSlug:i,projects:u,incident:o,stats:l,extraQueryParams:void 0!==d?{fields:["transaction.status","count()"],orderby:"-count",display:a.DC.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:a.DC.TOP5}}),buttonText:(0,n.t)("Open in Discover"),title:void 0===d?(0,n.t)("Failure rate by transaction"):void 0}}}];function R(t){var e,r;const{opts:{orgSlug:o,projects:u,incident:l,stats:p},tooltip:R}=t;if(!l||!p)return{to:"",buttonText:(0,n.t)("Incident details")};const S=null===(r=new s.MY(null!==(e=l.discoverQuery)&&void 0!==e?e:"").getFilterValues("transaction"))||void 0===r?void 0:r.find((t=>!t.includes("*")));if(void 0!==S){const t=(0,i.Eq)(p);return{to:(0,d.e1)({orgSlug:o,transaction:S,projectID:u.filter((t=>{let{slug:e}=t;return l.projects.includes(e)})).map((t=>{let{id:e}=t;return e})),query:{...t}}),buttonText:(0,n.t)("View Transaction Summary"),title:S}}const E={fields:[...new Set(["transaction","count()",l.alertRule.aggregate])],orderby:"-count",display:a.DC.TOP5};return{to:c({orgSlug:o,projects:u,incident:l,stats:p,extraQueryParams:E}),buttonText:(0,n.t)("Open in Discover"),title:R}}function S(t){let{orgSlug:e,projects:r,incident:s,stats:i}=t;if(!s)return{buttonText:(0,n.t)("Open in Discover"),to:""};const o={display:a.DC.TOP5};return{buttonText:(0,n.t)("Open in Discover"),to:c({orgSlug:e,projects:r,incident:s,stats:i,extraQueryParams:o})}}},"./app/views/alerts/incidentRules/types.tsx":(t,e,r)=>{r.d(e,{lT:()=>a,t6:()=>s,qz:()=>i,GM:()=>o,Yh:()=>u,lK:()=>l,XH:()=>c,Tb:()=>d,Us:()=>p,LO:()=>R,Lm:()=>S,hd:()=>E});var n=r("./app/locale.tsx");let a,s,i,o,u,l,c,d,p;!function(t){t[t.ABOVE=0]="ABOVE",t[t.BELOW=1]="BELOW"}(a||(a={})),function(t){t.COUNT="count",t.CHANGE="change"}(s||(s={})),function(t){t.ERRORS="events",t.TRANSACTIONS="transactions",t.SESSIONS="sessions"}(i||(i={})),function(t){t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction",t.USER="user",t.SESSION="session"}(o||(o={})),function(t){t.ERROR_DEFAULT="error_default",t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction"}(u||(u={})),function(t){t.CRASH_FREE_SESSIONS="percentage(sessions_crashed, sessions) AS _crash_rate_alert_aggregate",t.CRASH_FREE_USERS="percentage(users_crashed, users) AS _crash_rate_alert_aggregate"}(l||(l={})),function(t){t.SIX_HOURS="6h",t.ONE_DAY="1d",t.THREE_DAYS="3d",t.SEVEN_DAYS="10000m",t.FOURTEEN_DAYS="14d",t.THIRTY_DAYS="30d"}(c||(c={})),function(t){t[t.ONE_MINUTE=1]="ONE_MINUTE",t[t.FIVE_MINUTES=5]="FIVE_MINUTES",t[t.TEN_MINUTES=10]="TEN_MINUTES",t[t.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",t[t.THIRTY_MINUTES=30]="THIRTY_MINUTES",t[t.ONE_HOUR=60]="ONE_HOUR",t[t.TWO_HOURS=120]="TWO_HOURS",t[t.FOUR_HOURS=240]="FOUR_HOURS",t[t.ONE_DAY=1440]="ONE_DAY"}(d||(d={})),function(t){t.EMAIL="email",t.SLACK="slack",t.PAGERDUTY="pagerduty",t.MSTEAMS="msteams",t.SENTRY_APP="sentry_app"}(p||(p={}));const R={[p.EMAIL]:(0,n.t)("Email"),[p.SLACK]:(0,n.t)("Slack"),[p.PAGERDUTY]:(0,n.t)("Pagerduty"),[p.MSTEAMS]:(0,n.t)("MS Teams"),[p.SENTRY_APP]:(0,n.t)("Notification")};let S;!function(t){t.SPECIFIC="specific",t.USER="user",t.TEAM="team",t.SENTRY_APP="sentry_app"}(S||(S={}));const E={[S.USER]:(0,n.t)("Member"),[S.TEAM]:(0,n.t)("Team")}},"./app/views/alerts/utils/index.tsx":(t,e,r)=>{r.d(e,{dX:()=>S,hl:()=>E,yN:()=>T,Un:()=>v,Eq:()=>f,Gm:()=>O,CM:()=>g,Ey:()=>_,KC:()=>A,A4:()=>m,Eb:()=>N,Vc:()=>x,lR:()=>y,qn:()=>h,t3:()=>U,QR:()=>I}),r("../node_modules/core-js/modules/es.string.replace.js");var n=r("../node_modules/lodash/round.js"),a=r.n(n),s=r("./app/api.tsx"),i=r("./app/locale.tsx"),o=r("./app/types/index.tsx"),u=r("./app/utils.tsx"),l=r("./app/utils/dates.tsx"),c=r("./app/utils/discover/charts.tsx"),d=r("./app/views/alerts/incidentRules/presets.tsx"),p=r("./app/views/alerts/incidentRules/types.tsx");const R=new s.KU;function S(t,e){return R.requestPromise(`/organizations/${t}/alert-rules/${e}/`)}function E(t,e,r,n){return R.requestPromise(`/organizations/${t}/incidents/`,{query:{alertRule:e,includeSnapshots:!0,start:r,end:n,expand:["activities","seen_by","original_alert_rule"]}})}function T(t,e,r){return t.requestPromise(`/organizations/${e}/incidents/${r}/`)}function v(t){var e,r;const n=null==t?void 0:t.alertRule,a=null!==(e=null==n?void 0:n.aggregate)&&void 0!==e?e:"",s=null!==(r=null==n?void 0:n.dataset)&&void 0!==r?r:p.qz.ERRORS;return d.g.find((t=>t.validDataset.includes(s)&&t.match.test(a)))}function f(t){return{start:(0,l.v5)(1e3*t.eventStats.data[0][0]),end:(0,l.v5)(1e3*t.eventStats.data[t.eventStats.data.length-1][0])}}function O(t){return!t.hasOwnProperty("triggers")}const g={[p.qz.ERRORS]:(0,i.t)("Errors"),[p.qz.TRANSACTIONS]:(0,i.t)("Transactions"),[p.Yh.ERROR_DEFAULT]:"event.type:error OR event.type:default",[p.Yh.ERROR]:"event.type:error",[p.Yh.DEFAULT]:"event.type:default",[p.Yh.TRANSACTION]:"event.type:transaction"},_={[p.Yh.ERROR_DEFAULT]:{dataset:p.qz.ERRORS,eventTypes:[p.GM.ERROR,p.GM.DEFAULT]},[p.Yh.ERROR]:{dataset:p.qz.ERRORS,eventTypes:[p.GM.ERROR]},[p.Yh.DEFAULT]:{dataset:p.qz.ERRORS,eventTypes:[p.GM.DEFAULT]},[p.Yh.TRANSACTION]:{dataset:p.qz.TRANSACTIONS,eventTypes:[p.GM.TRANSACTION]}};function A(t,e){return t===p.qz.TRANSACTIONS?p.Yh.TRANSACTION:e?e.includes(p.GM.DEFAULT)&&e.includes(p.GM.ERROR)?p.Yh.ERROR_DEFAULT:e.includes(p.GM.DEFAULT)?p.Yh.DEFAULT:p.Yh.ERROR:p.Yh.ERROR}function m(t){let e=t.match(/\(?\bevent\.type:(error|default|transaction)\)?\WOR\W\(?event\.type:(error|default|transaction)\)?/i);return e?"default,error"!==e.slice(1,3).sort().join(",")?null:{source:p.Yh.ERROR_DEFAULT,query:t.replace(e[0],"").trim()}:(e=t.match(/(^|\s)event\.type:(error|default|transaction)/i),e&&p.Yh[e[2].toUpperCase()]?{source:p.Yh[e[2].toUpperCase()],query:t.replace(e[0],"").trim()}:null)}function N(t){return Object.values(p.lK).includes(t)}const x={[p.lK.CRASH_FREE_SESSIONS]:o.r2.SESSIONS,[p.lK.CRASH_FREE_USERS]:o.r2.USERS};function y(t,e,r){return N(r)?(0,u.ri)(t)?`${a()(t,2)}%`:"―":(0,c.gu)(t,e)}function h(t,e,r){return N(r)?(0,u.ri)(t)?`${t}%`:"―":(0,c.CX)(t,e)}const U=1.03;function I(t){return N(t)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_incidentRules_presets_tsx-app_views_alerts_utils_index_tsx.0b26fe48d0641beb6dd013da809c9ee3.js.map