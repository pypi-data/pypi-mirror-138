"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>P});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),a=s("../node_modules/lodash/assign.js"),o=s.n(a),l=s("../node_modules/lodash/flatten.js"),d=s.n(l),u=s("../node_modules/lodash/isEqual.js"),c=s.n(u),p=s("../node_modules/lodash/memoize.js"),m=s.n(p),h=s("../node_modules/lodash/omit.js"),v=s.n(h),g=s("./app/actionCreators/tags.tsx"),f=s("./app/components/smartSearchBar/index.tsx"),Z=s("./app/constants/index.tsx"),x=s("./app/types/index.tsx"),y=s("./app/utils.tsx"),b=s("./app/utils/discover/fields.tsx"),w=s("./app/utils/measurements/measurements.tsx"),j=s("./app/utils/withApi.tsx"),_=s("./app/utils/withTags.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S=new RegExp(`^${Z.c$}|\\${Z.ir}`,"g");class N extends i.PureComponent{constructor(){super(...arguments),(0,n.Z)(this,"getEventFieldValues",m()(((e,t,s)=>{const{api:n,organization:i,projectIds:r,includeSessionTagsValues:a}=this.props,o=null==r?void 0:r.map(String);return(0,b.h1)(e.key)||(0,b.Xr)(e.key)?Promise.resolve([]):(0,g.Fo)(n,i.slug,e.key,t,o,s,!0,a).then((e=>d()(e.filter((e=>{let{name:t}=e;return(0,y.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`}))),(0,n.Z)(this,"prepareQuery",(e=>e.replace(S,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;c()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:n,omitTags:i}=this.props,r=t?Object.fromEntries(t.filter((e=>!Object.keys(b.wZ).includes(e.field)&&!(0,b.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},a=s.features.includes("performance-view")?Object.assign({},e,b.wZ,r):v()(b.wZ,b.J8),l=o()({},n,a,b.jg);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},v()(l,null!=i?i:[])}render(){const{organization:e}=this.props;return(0,k.tZ)(w.Z,{organization:e,children:e=>{let{measurements:t}=e;const s=this.getTagList(t);return(0,k.tZ)(r.ms,{children:e=>{let{css:t}=e;return(0,k.tZ)(f.Z,{hasRecentSearches:!0,savedSearchType:x.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:s,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:t`
                    max-height: 300px;
                    overflow-y: auto;
                  `,...this.props})}})}})}}N.displayName="SearchBar";const P=(0,j.Z)((0,_.Z)(N))},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=s("../node_modules/react/index.js"),i=s("./app/utils/performance/vitals/constants.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,s]=e;return[t,{name:s.name,key:t}]})))}const o=a(i.TT),l=a(i.r9);function d(e){let{organization:t,children:s}=e;const i=t.features.includes("performance-mobile-vitals")?{...l,...o}:l;return(0,r.tZ)(n.Fragment,{children:s({measurements:i})})}d.displayName="Measurements";const u=d},"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js");var n=s("../node_modules/lodash/pick.js"),i=s.n(n),r=s("./app/utils/discover/genericDiscoverQuery.tsx"),a=s("./app/utils/performance/constants.tsx"),o=s("./app/utils/withApi.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){const{eventView:t,vitals:s}=e,n=null==t?void 0:t.getEventsAPIPayload(e.location);return{vital:s,...i()(n,["query",...Object.values(a.s)])}}function u(e){return(0,l.tZ)(r.ZP,{getRequestPayload:d,route:"events-vitals",...e,children:t=>{let{tableData:s,...n}=t;return e.children({vitalsData:s,...n})}})}u.displayName="VitalsCardsDiscoverQuery";const c=(0,o.Z)(u)},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{tags:r.Z.getAllTags()}),(0,n.Z)(this,"unsubscribe",r.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,o.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName",`withTags(${(0,a.Z)(e)})`),t}},"./app/views/performance/landing/vitalsCards.tsx":(e,t,s)=>{s.d(t,{M9:()=>R,q7:()=>I,aU:()=>U,JO:()=>ee});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react/index.js"),r=s("../node_modules/@sentry/minimal/esm/index.js"),a=s("./app/components/card.tsx"),o=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/styles.tsx"),d=s("./app/components/charts/utils.tsx"),u=s("./app/components/emptyStateWarning.tsx"),c=s("./app/components/links/link.tsx"),p=s("./app/components/placeholder.tsx"),m=s("./app/components/questionTooltip.tsx"),h=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),v=s("../node_modules/react-sparklines/build/index.js"),g=s("../node_modules/prop-types/index.js"),f=s.n(g);class Z extends v.Sparklines{}(0,h.Z)(Z,"propTypes",{children:f().node,data:f().array,limit:f().number,width:f().number,height:f().number,svgWidth:f().number,svgHeight:f().number,preserveAspectRatio:f().string,margin:f().number,style:f().object,min:f().number,max:f().number,onMouseMove:f().func});var x=s("./app/components/tooltip.tsx"),y=s("./app/locale.tsx"),b=s("./app/styles/overflowEllipsis.tsx"),w=s("./app/styles/space.tsx"),j=s("./app/utils.tsx"),_=s("./app/utils/dates.tsx"),k=s("./app/utils/discover/discoverQuery.tsx"),S=s("./app/utils/discover/fields.tsx"),N=s("./app/utils/performance/vitals/constants.tsx"),P=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),C=s("./app/utils/queryString.tsx"),T=s("./app/utils/theme.tsx"),O=s("./app/utils/useApi.tsx"),A=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const E=e=>(0,A.tZ)(D,{barHeight:e.barHeight,fractions:e.colorStops.map((e=>{let{percent:t}=e;return t})),children:e.colorStops.map((e=>(0,A.tZ)(z,{color:e.color},e.color)))});E.displayName="ColorBar";const D=(0,n.Z)("div",{target:"etd41501"})("height:",(e=>e.barHeight?`${e.barHeight}px`:"16px"),";width:100%;overflow:hidden;position:relative;background:",(e=>e.theme.gray100),";display:grid;grid-template-columns:",(e=>e.fractions.map((e=>`${e}fr`)).join(" ")),";margin-bottom:",(e=>e.barHeight?"":(0,w.Z)(1)),";border-radius:2px;"),z=(0,n.Z)("div",{target:"etd41500"})("background-color:",(e=>e.theme[e.color]),";"),V=E;var B=s("./app/views/performance/vitalDetail/utils.tsx"),H=s("./app/utils/formatters.tsx");function F(e,t){const s=Array.isArray(e)||e===S.Zl.CLS?"":"ms";switch(t){case B.SP.POOR:return Array.isArray(e)?(0,y.t)("Poor"):(0,y._N)("Poor: >[threshold][unit]",{threshold:B.eE[e],unit:s});case B.SP.MEH:return Array.isArray(e)?(0,y.t)("Meh"):(0,y._N)("Meh: >[threshold][unit]",{threshold:B.MN[e],unit:s});case B.SP.GOOD:return Array.isArray(e)?(0,y.t)("Good"):(0,y._N)("Good: <[threshold][unit]",{threshold:B.MN[e],unit:s});default:return null}}function L(e){return(0,A.tZ)(M,{children:e.percents.map((t=>(0,A.tZ)(x.Z,{title:F(e.vital,t.vitalState),disabled:e.hideTooltips,children:(0,A.BX)(q,{"data-test-id":"vital-status",children:[B.Np[t.vitalState],(0,A.BX)("span",{children:[e.showVitalPercentNames&&(0,y.t)(`${t.vitalState}`)," ",(0,H.rl)(t.percent,0)]})]})},t.vitalState)))})}L.displayName="VitalPercents";const M=(0,n.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,w.Z)(2),";"),q=(0,n.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,w.Z)(.5),";font-size:",(e=>e.theme.fontSizeMedium),";");var $=s("./app/views/performance/landing/utils.tsx");function I(e){const{eventView:t,location:s,organization:n,projects:i,frontendOnly:r=!1}=e;if(r&&(0,$.Oo)(i,t)!==$.BY.FRONTEND_PAGELOAD)return null;const a=[S.Zl.FCP,S.Zl.LCP,S.Zl.FID,S.Zl.CLS];return(0,A.tZ)(P.Z,{eventView:t,location:s,orgSlug:n.slug,vitals:a,children:e=>{let{isLoading:i,vitalsData:r}=e;return(0,A.tZ)(K,{children:a.map((e=>{var a,o,l;const d=(0,B.i4)({orgSlug:n.slug,query:t.generateQueryStringObject(),vitalName:e,projectID:(0,C.qP)(s.query.project)}),u=i?"—":ae(null!==(a=null==r?void 0:r[e])&&void 0!==a?a:null,e),p=(0,A.tZ)(G,{children:(0,A.tZ)(ee,{isLoading:i,vital:e,data:r})});return(0,A.tZ)(c.Z,{to:d,"data-test-id":`vitals-linked-card-${B.a7[e]}`,children:(0,A.tZ)(se,{title:null!==(o=B.jo[e])&&void 0!==o?o:"",tooltip:null!==(l=N.r9[e].description)&&void 0!==l?l:"",value:i?"—":u,chart:p,minHeight:150})},e)}))})}})}I.displayName="FrontendCards";const G=(0,n.Z)("div",{target:"e1he14ku9"})("margin-top:",(0,w.Z)(1.5),";");function Q(e){const t=(0,O.Z)(),{eventView:s,location:n,organization:i,functions:a}=e,{query:l}=n,u=s.withColumns(a),c=u.getPageFilters(),p=c.datetime.start?(0,_.hC)(c.datetime.start):void 0,m=c.datetime.end?(0,_.hC)(c.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:p||null,end:m||null,period:c.datetime.period},"low"),v=u.getEventsAPIPayload(n);return(0,A.tZ)(k.Z,{location:n,eventView:u,orgSlug:i.slug,limit:1,referrer:"api.performance.vitals-cards",children:e=>{let{isLoading:s,tableData:n}=e;return(0,A.tZ)(o.Z,{api:t,organization:i,period:c.datetime.period,project:c.projects,environment:c.environments,team:v.team,start:p,end:m,interval:h,query:v.query,includePrevious:!1,yAxis:u.getFields(),partial:!0,children:e=>{let{results:t}=e;const o=null==t?void 0:t.reduce(((e,t)=>(e[t.seriesName]=t.data.map((e=>e.value)),e)),{}),l=(0,$.hv)(i);return(0,A.tZ)(K,{children:a.map((e=>{var t,i;let a=(0,S.sN)(e);a.includes("apdex")&&(a="apdex()");const d=l[a];if(!d)return r.uT(`Missing field '${a}' in vital cards.`),null;const{title:u,tooltip:c,formatter:p}=d,m=(0,S.LY)(a),h=null==n||null===(t=n.data)||void 0===t||null===(i=t[0])||void 0===i?void 0:i[m],v=null==o?void 0:o[a],g=s||!(0,j.ri)(h)?"—":p(h),f=(0,A.tZ)(J,{data:v});return(0,A.tZ)(se,{title:u,tooltip:c,value:g,chart:f,horizontal:!0,minHeight:96,isNotInteractive:!0},a)}))})}})}})}function X(e){return(0,A.tZ)(Q,{...e,functions:[{kind:"function",function:["p75","transaction.duration",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]}]})}Q.displayName="GenericCards",X.displayName="_BackendCards";const R=X;function W(e){const t=[{kind:"function",function:["p75","measurements.app_start_cold",void 0,void 0]},{kind:"function",function:["p75","measurements.app_start_warm",void 0,void 0]}];return e.showStallPercentage?t.push({kind:"function",function:["p75","measurements.stall_percentage",void 0,void 0]}):(t.push({kind:"function",function:["p75","measurements.frames_slow_rate",void 0,void 0]}),t.push({kind:"function",function:["p75","measurements.frames_frozen_rate",void 0,void 0]})),(0,A.tZ)(Q,{...e,functions:t})}W.displayName="_MobileCards";const U=W;function J(e){const{data:t}=e,s=T.ZP.charts.getColorPalette(1)[0];return(0,A.tZ)(Y,{"data-test-id":"sparkline",width:150,height:24,children:(0,A.tZ)(Z,{data:t,width:150,height:24,children:(0,A.tZ)(v.SparklinesLine,{style:{stroke:s,fill:"none",strokeWidth:3}})})})}J.displayName="SparklineChart";const Y=(0,n.Z)("div",{target:"e1he14ku8"})("flex-grow:4;max-height:",(e=>e.height),"px;max-width:",(e=>e.width),"px;margin:",(0,w.Z)(1)," ",(0,w.Z)(0)," ",(0,w.Z)(.5)," ",(0,w.Z)(3),";"),K=(0,n.Z)("div",{target:"e1he14ku7"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,w.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function ee(e){var t;const{isLoading:s,data:n,vital:r,value:a,showBar:o=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:u=!1,showDetail:c=!0,showTooltip:m=!1,barHeight:h}=e;if(s)return l?(0,A.tZ)(p.Z,{height:"48px"}):null;const v=l?(0,A.tZ)(te,{small:!0,children:(0,y.t)("No vitals found")}):null;if(!n)return v;const g={poor:0,meh:0,good:0,total:0};if((Array.isArray(r)?r:[r]).forEach((e=>{var t;const s=null!==(t=null==n?void 0:n[e])&&void 0!==t?t:{};Object.keys(g).forEach((e=>g[e]+=s[e]))})),!g.total)return v;const f=Array.isArray(r)?null:null!=a?a:ae(null!==(t=null==n?void 0:n[r])&&void 0!==t?t:null,r),Z=function(e){let{poor:t,meh:s,good:n,total:i}=e;const r=t/i,a=s/i,o=n/i;return[{vitalState:B.SP.GOOD,percent:o},{vitalState:B.SP.MEH,percent:a},{vitalState:B.SP.POOR,percent:r}]}(g),x=function(e){return e.map((e=>{let{percent:t,vitalState:s}=e;return{percent:t,color:B.fL[s]}}))}(Z);return(0,A.BX)(i.Fragment,{children:[o&&(0,A.tZ)(re,{title:(0,A.tZ)(L,{vital:r,percents:Z,showVitalPercentNames:!0,hideTooltips:m}),disabled:!m,position:"bottom",children:(0,A.tZ)(V,{barHeight:h,colorStops:x})}),c&&(0,A.BX)(oe,{children:[d&&f&&(0,A.BX)("div",{children:[(0,y.t)("The p75 for all transactions is "),(0,A.tZ)("strong",{children:f})]}),(0,A.tZ)(L,{vital:r,percents:Z,showVitalPercentNames:u})]})]})}ee.displayName="VitalBar";const te=(0,n.Z)(u.Z,{target:"e1he14ku6"})("height:48px;padding:",(0,w.Z)(1.5)," 15%;");function se(e){const{chart:t,minHeight:s,horizontal:n,title:i,tooltip:r,value:a,isNotInteractive:o}=e;return(0,A.BX)(ie,{interactive:!o,minHeight:s,children:[(0,A.BX)(l.Gh,{children:[(0,A.tZ)(de,{children:(0,y.t)(i)}),(0,A.tZ)(m.Z,{size:"sm",position:"top",title:r})]}),(0,A.BX)(ne,{horizontal:n,children:[(0,A.tZ)(le,{children:a}),t]})]})}se.displayName="VitalCard";const ne=(0,n.Z)("div",{target:"e1he14ku5"})("width:100%;display:flex;flex-direction:",(e=>e.horizontal?"row":"column"),";justify-content:space-between;"),ie=(0,n.Z)(a.Z,{target:"e1he14ku4"})("color:",(e=>e.theme.textColor),";padding:",(0,w.Z)(2)," ",(0,w.Z)(3),";align-items:flex-start;margin-bottom:",(0,w.Z)(2),";",(e=>e.minHeight&&`min-height: ${e.minHeight}px`),";"),re=(0,n.Z)(x.Z,{target:"e1he14ku3"})({name:"1d3w5wq",styles:"width:100%"});function ae(e,t){var s;const n=null!==(s=null==e?void 0:e.p75)&&void 0!==s?s:null;return null===n?"—":t===S.Zl.CLS?n.toFixed(2):`${n.toFixed(0)}ms`}const oe=(0,n.Z)("div",{target:"e1he14ku2"})("font-size:",(e=>e.theme.fontSizeMedium),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),le=(0,n.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,w.Z)(1),";"),de=(0,n.Z)("div",{target:"e1he14ku0"})(b.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx.17889adafbb6165d05203dd07f33498a.js.map