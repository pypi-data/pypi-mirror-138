(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_mean_js-node_modules_-a7c1d4","node_modules_lodash_mean_js"],{"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l}),r("../node_modules/react/index.js");var s=r("./app/utils/withApi.tsx"),n=r("./app/utils/discover/genericDiscoverQuery.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,i.tZ)(n.ZP,{route:"eventsv2",shouldRefetchData:o,...e})}a.displayName="DiscoverQuery";const l=(0,s.Z)(a)},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{AA:()=>p,ZP:()=>h});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),i=r("./app/locale.tsx"),o=r("./app/utils/discover/eventView.tsx"),a=r("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=r("./app/utils/useOrganization.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends n.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null}),(0,s.Z)(this,"_shouldRefetchData",(e=>{const t=this.getPayload(this.props),r=this.getPayload(e);return!(0,o.ze)(t,r)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,s.Z)(this,"fetchData",(async()=>{const{api:e,beforeFetch:t,afterFetch:r,didFetch:s,eventView:n,orgSlug:o,route:a,setError:l}=this.props;if(!n.isValid())return;const d=`/organizations/${o}/${a}/`,c=Symbol("tableFetchID"),u=this.getPayload(this.props);this.setState({isLoading:!0,tableFetchID:c}),null==l||l(void 0),null==t||t(e),e.clear();try{const[t,,n]=await p(e,d,u);if(this.state.tableFetchID!==c)return;const i=r?r(t,this.props):t;null==s||s(i),this.setState((e=>{var t;return{isLoading:!1,tableFetchID:void 0,error:null,pageLinks:null!==(t=null==n?void 0:n.getResponseHeader("Link"))&&void 0!==t?t:e.pageLinks,tableData:i}}))}catch(e){var h;const t=(null==e||null===(h=e.responseJSON)||void 0===h?void 0:h.detail)||(0,i.t)("An unknown error occurred.");this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),l&&l(t)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),r=!1===e.eventView.isValid()&&this.props.eventView.isValid(),s=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||r||s)&&this.fetchData()}getPayload(e){const{cursor:t,limit:r,noPagination:s,referrer:n}=e,i=this.props.getRequestPayload?this.props.getRequestPayload(e):e.eventView.getEventsAPIPayload(e.location);return t&&(i.cursor=t),r&&(i.per_page=r),s&&(i.noPagination=s),n&&(i.referrer=n),i}render(){const{isLoading:e,error:t,tableData:r,pageLinks:s}=this.state,n={isLoading:e,error:t,tableData:r,pageLinks:s},i=this.props.children;return null==i?void 0:i(n)}}function u(e){var t,r;const s=null!==(t=e.orgSlug)&&void 0!==t?t:(0,l.Z)().slug,n=null!==(r=e.eventView)&&void 0!==r?r:(0,a.wj)(),i={...e,orgSlug:s,eventView:n};return(0,d.tZ)(c,{...i})}async function p(e,t,r){return e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...r}})}c.displayName="_GenericDiscoverQuery",u.displayName="GenericDiscoverQuery";const h=u},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,r)=>{"use strict";r.d(t,{bq:()=>n,wj:()=>o}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=r("./app/utils/performance/contexts/utils.tsx");const[n,i]=(0,s.n)({name:"PerformanceEventViewContext"});function o(){return i().eventView}},"./app/utils/performance/contexts/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var s=r("../node_modules/react/index.js");function n(e){const{strict:t=!0,errorMessage:r=`useContext for "${e.name}" must be inside a Provider with a value`,name:n}=e,i=s.createContext(void 0);return i.displayName=n,[i.Provider,function(){const e=s.useContext(i);if(!e&&t)throw new Error(r);return e},i]}},"./app/views/organizationStats/teamInsights/health.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Le});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),i=r("./app/components/layouts/thirds.tsx"),o=r("./app/components/loadingIndicator.tsx"),a=r("./app/components/noProjectMessage.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),d=r("./app/locale.tsx"),c=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),u=r("./app/utils/localStorage.tsx"),p=r("./app/utils/useOrganization.tsx"),h=r("./app/utils/useTeams.tsx"),g=r("./app/views/organizationStats/header.tsx"),m=r("./app/views/organizationStats/teamInsights/controls.tsx"),Z=r("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),v=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),f=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),y=r("../node_modules/lodash/round.js"),x=r.n(y),b=r("./app/components/asyncComponent.tsx"),w=r("./app/components/button.tsx"),j=r("./app/components/charts/barChart.tsx"),S=r("./app/components/links/link.tsx"),_=r("./app/components/organizations/pageFilters/parse.tsx"),z=r("./app/components/panels/panelTable.tsx"),T=r("./app/icons/index.tsx"),D=r("./app/styles/overflowEllipsis.tsx"),k=r("./app/styles/space.tsx"),M=r("./app/utils/formatters.tsx"),q=r("./app/views/organizationStats/teamInsights/styles.tsx"),N=r("./app/views/organizationStats/teamInsights/utils.tsx"),P=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class R extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null,alertsTriggeredRules:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:i}=this.props,o={start:t,end:r,period:s,utc:n};return[["alertsTriggered",`/teams/${e.slug}/${i}/alerts-triggered/`,{query:{...(0,_.fK)(o)}}],["alertsTriggeredRules",`/teams/${e.slug}/${i}/alerts-triggered-index/`,{query:{...(0,_.fK)(o)}}]]}componentDidUpdate(e){const{start:t,end:r,period:s,utc:n,teamSlug:i}=this.props;e.start===t&&e.end===r&&e.period===s&&e.utc===n&&e.teamSlug===i||this.remountComponent()}renderTrend(e){const{weeklyAvg:t,totalThisWeek:r}=e,s=r-t;return 0===t?"—":(0,P.BX)($,{color:s<=0?"green300":"red300",children:[(0,M.rl)(Math.abs(s/t),0),(0,P.tZ)(I,{direction:s<=0?"down":"up",size:"xs"})]})}renderLoading(){return(0,P.tZ)(C,{children:(0,P.tZ)(o.Z,{})})}renderBody(){const{organization:e,period:t,projects:r}=this.props,{alertsTriggered:s,alertsTriggeredRules:i}=this.state,o=(0,N.bI)((0,N.E7)(null!=s?s:{}));return(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(C,{children:(0,P.tZ)(j.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:(0,N.tP)(o.length),series:[{seriesName:(0,d.t)("Alerts Triggered"),data:o,silent:!0,barCategoryGap:"5%"}]})}),(0,P.tZ)(L,{isEmpty:!s||!i||0===i.length,emptyMessage:(0,d.t)("No alerts triggered for this team’s projects"),emptyAction:(0,P.BX)(X,{children:[(0,P.tZ)(w.ZP,{priority:"primary",size:"small",to:`/organizations/${e.slug}/alerts/rules/`,children:(0,d.t)("Create Alert")}),(0,P.tZ)(w.ZP,{size:"small",external:!0,to:"https://docs.sentry.io/product/alerts/create-alerts/",children:(0,d.t)("Learn more")})]}),headers:[(0,d.t)("Alert Rule"),(0,d.t)("Project"),(0,P.tZ)(E,{children:(0,d._N)("Last [period] Average",{period:t})},"last"),(0,P.tZ)(E,{children:(0,d.t)("This Week")},"curr"),(0,P.tZ)(E,{children:(0,d.t)("Difference")},"diff")],children:null==i?void 0:i.map((t=>{const s=r.find((e=>e.slug===t.projects[0]));return(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(A,{children:(0,P.tZ)(S.Z,{to:`/organizations/${e.slug}/alerts/rules/details/${t.id}/`,children:t.name})}),(0,P.tZ)(q.R,{children:s&&(0,P.tZ)(q.W,{avatarSize:18,project:s})}),(0,P.tZ)(E,{children:x()(t.weeklyAvg,2)}),(0,P.tZ)(E,{children:t.totalThisWeek}),(0,P.tZ)(E,{children:this.renderTrend(t)})]},t.id)}))})]})}}const B=R,C=(0,s.Z)("div",{target:"e1w90l1w6"})("padding:",(0,k.Z)(2)," ",(0,k.Z)(2)," 0 ",(0,k.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),L=(0,s.Z)(z.Z,{target:"e1w90l1w5"})("grid-template-columns:1fr 0.5fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,k.Z)(1)," ",(0,k.Z)(2),";}",(e=>e.isEmpty&&(0,f.iv)("&>div:last-child{padding:48px ",(0,k.Z)(2),";}","")),";"),A=(0,s.Z)("div",{target:"e1w90l1w4"})(D.Z,";"),E=(0,s.Z)("div",{target:"e1w90l1w3"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"}),I=(0,s.Z)(T.CC,{target:"e1w90l1w2"})("margin:0 ",(0,k.Z)(.5),";"),$=(0,s.Z)("div",{target:"e1w90l1w1"})("color:",(e=>e.theme[e.color]),";"),X=(0,s.Z)("div",{target:"e1w90l1w0"})("&>a{margin-right:",(0,k.Z)(.5),";margin-left:",(0,k.Z)(.5),";}");var F=r("./app/components/loadingError.tsx"),V=r("./app/utils/discover/discoverQuery.tsx"),W=r("./app/utils/discover/eventView.tsx"),G=r("./app/utils/discover/fieldRenderers.tsx"),O=r("./app/views/performance/transactionSummary/utils.tsx");function Q(e){var t;let{organization:r,location:s,projects:i,periodTableData:o,weekTableData:a,isLoading:l,period:c,error:u}=e;const[p,h]=(0,n.useState)(!1),g=(null==o?void 0:o.meta)&&(0,G.Js)("user_misery",o.meta),m=(null!==(t=null==o?void 0:o.data)&&void 0!==t?t:[]).map((e=>{const t=null==a?void 0:a.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e.user_misery-t.user_misery):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),Z=(0,N.NW)(m);return u?(0,P.tZ)(F.Z,{}):(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(H,{isEmpty:0===i.length||0===(null==o?void 0:o.data.length),emptyMessage:(0,d.t)("No key transactions starred by this team"),emptyAction:(0,P.tZ)(w.ZP,{size:"small",external:!0,href:"https://docs.sentry.io/product/performance/transaction-summary/#starring-key-transactions",children:(0,d.t)("Learn More")}),headers:[(0,P.BX)(J,{children:[(0,P.tZ)(ee,{isSolid:!0,color:"yellow300"})," ",(0,d.t)("Key transaction")]},"transaction"),(0,d.t)("Project"),(0,d._N)("Last [period]",{period:c}),(0,d.t)("Last 7 Days"),(0,P.tZ)(re,{children:(0,d.t)("Change")},"change")],isLoading:l,children:Z.map(((e,t)=>{const o=i.find((t=>{let{slug:r}=t;return e.project===r})),{trend:l,project:c,transaction:u}=e,h=null==a?void 0:a.data.find((e=>e.project===c&&e.transaction===u));if(!h||null===l)return null;const m=null==g?void 0:g(e,{organization:r,location:s}),Z=h&&(null==g?void 0:g(h,{organization:r,location:s})),v=Math.round(Math.abs(l));return t>=5&&!p?null:(0,P.BX)(n.Fragment,{children:[(0,P.BX)(Y,{children:[(0,P.tZ)("div",{children:(0,P.tZ)(ee,{isSolid:!0,color:"yellow300"})}),(0,P.tZ)(te,{children:(0,P.tZ)(S.Z,{to:(0,O.e1)({orgSlug:r.slug,transaction:e.transaction,projectID:null==o?void 0:o.id,query:{query:"transaction.duration:<15m"}}),children:e.transaction})})]}),(0,P.tZ)(J,{children:(0,P.tZ)(q.R,{children:o&&(0,P.tZ)(q.W,{avatarSize:18,project:o})})}),(0,P.tZ)(J,{children:m}),(0,P.tZ)(J,{children:null!=Z?Z:"—"}),(0,P.tZ)(se,{children:0===v?(0,P.BX)(ne,{children:["0% ",(0,d.t)("change")]}):(0,P.BX)(ie,{color:l>=0?"green300":"red300",children:[`${v}% `,l>=0?(0,d.t)("better"):(0,d.t)("worse")]})})]},t)}))}),Z.length>=5&&!p&&!l&&(0,P.BX)(oe,{onClick:function(){h(!0)},children:[(0,P.BX)(le,{children:[(0,P.tZ)(ae,{color:"gray300"}),(0,d._N)("Show [count] More",{count:Z.length-1-5})]}),(0,P.tZ)(T.g6,{color:"gray300",direction:"down"})]})]})}function K(e){let{organization:t,teamId:r,projects:s,location:n,period:i,start:o,end:a}=e;if(0===s.length)return(0,P.tZ)(Q,{isLoading:!1,organization:t,location:n,projects:[],period:i,periodTableData:{data:[]},weekTableData:{data:[]}});const l={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:[],version:2,orderby:"-tpm",teams:[Number(r)],fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},d=W.ZP.fromSavedQuery({...l,name:"periodMisery",range:null!=i?i:void 0,start:o,end:a}),c=W.ZP.fromSavedQuery({...l,name:"weekMisery",range:"7d"});return(0,P.tZ)(V.Z,{eventView:d,orgSlug:t.slug,location:n,children:e=>{let{isLoading:r,tableData:o,error:a}=e;return(0,P.tZ)(V.Z,{eventView:c,orgSlug:t.slug,location:n,children:e=>{let{isLoading:l,tableData:d,error:c}=e;return(0,P.tZ)(Q,{isLoading:r||l,organization:t,location:n,projects:s,period:i,periodTableData:o,weekTableData:d,error:null!=a?a:c})}})}})}Q.displayName="TeamMisery",K.displayName="TeamMiseryWrapper";const U=K,H=(0,s.Z)(z.Z,{target:"e1uglq211"})("grid-template-columns:1.25fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,k.Z)(1)," ",(0,k.Z)(2),";}",(e=>e.isEmpty&&(0,f.iv)("&>div:last-child{padding:48px ",(0,k.Z)(2),";}","")),";"),J=(0,s.Z)("div",{target:"e1uglq210"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),Y=(0,s.Z)("div",{target:"e1uglq29"})(D.Z,";display:flex;align-items:center;"),ee=(0,s.Z)(T.GK,{target:"e1uglq28"})("display:block;margin-right:",(0,k.Z)(1),";margin-bottom:",(0,k.Z)(.5),";"),te=(0,s.Z)("div",{target:"e1uglq27"})(D.Z,";"),re=(0,s.Z)("span",{target:"e1uglq26"})({name:"2qga7i",styles:"text-align:right"}),se=(0,s.Z)("div",{target:"e1uglq25"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ne=(0,s.Z)("div",{target:"e1uglq24"})("color:",(e=>e.theme.subText),";"),ie=(0,s.Z)("div",{target:"e1uglq23"})("color:",(e=>e.theme[e.color]),";"),oe=(0,s.Z)("div",{target:"e1uglq22"})("display:flex;align-items:center;padding:",(0,k.Z)(1)," ",(0,k.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";cursor:pointer;border-top:1px solid ",(e=>e.theme.border),";"),ae=(0,s.Z)(T.Zd,{target:"e1uglq21"})("margin-right:",(0,k.Z)(1),";"),le=(0,s.Z)("div",{target:"e1uglq20"})({name:"18keaja",styles:"display:flex;align-items:center;flex-grow:1"});var de=r("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),ce=r("../node_modules/lodash/isEqual.js"),ue=r.n(ce),pe=r("../node_modules/moment/moment.js"),he=r.n(pe),ge=r("./app/components/charts/components/markLine.tsx"),me=r("./app/components/placeholder.tsx");class Ze extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:i}=this.props,o={start:t,end:r,period:s,utc:n};return[["periodReleases",`/teams/${e.slug}/${i}/release-count/`,{query:{...(0,_.fK)(o)}}],["weekReleases",`/teams/${e.slug}/${i}/release-count/`,{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:s,period:n,utc:i}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===i&&ue()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:s}=this.state,n="week"===t?null==s?void 0:s.last_week_totals:null==r?void 0:r.project_avgs;return null!=n&&n[e]?Math.ceil(null==n?void 0:n[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,P.tZ)("div",{children:(0,P.tZ)(me.Z,{width:"80px",height:"25px"})});const s=this.getReleaseCount(Number(e),t);return null===s?"—":s}renderTrend(e){const{loading:t}=this.state;if(t)return(0,P.tZ)("div",{children:(0,P.tZ)(me.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,P.BX)(je,{color:r>=0?"green300":"red300",children:[`${x()(Math.abs(r),3)}`,(0,P.tZ)(we,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){var e,t;const{projects:r,period:s,theme:i,organization:o}=this.props,{periodReleases:a}=this.state,l=r.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),c=(0,N.NW)(l),u=Object.entries(null!==(e=null==a?void 0:a.release_counts)&&void 0!==e?e:{}).map((e=>{let[t,r]=e;return{value:Math.ceil(r),name:new Date(t).getTime()}})),p=(0,N.bI)(u),h=Object.values(null!==(t=null==a?void 0:a.project_avgs)&&void 0!==t?t:{}),g=h.reduce(((e,t)=>e+t),0),m=Math.ceil(g/h.length);return(0,P.BX)("div",{children:[(0,P.tZ)(fe,{children:(0,P.tZ)(j.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,N.tP)(p.length),series:[{seriesName:(0,d.t)("This Period"),silent:!0,data:p,markLine:(0,ge.Z)({silent:!0,lineStyle:{color:i.gray200,type:"dashed",width:1},data:[{yAxis:m}],label:{show:!1}}),barCategoryGap:"5%"}],tooltip:{formatter:e=>{const[t]=Array.isArray(e)?e:[e],r="MMM D",n=he()(t.data[0]).format(r),i=he()(t.data[0]).add(7,"days").format(r);return['<div class="tooltip-series">',`<div><span class="tooltip-label">${t.marker} <strong>${t.seriesName}</strong></span> ${t.data[1]}</div>`,`<div><span class="tooltip-label"><strong>Last ${s} Average</strong></span> ${m}</div>`,"</div>",`<div class="tooltip-date">${n} - ${i}</div>`,'<div class="tooltip-arrow"></div>'].join("")}}})}),(0,P.tZ)(ye,{isEmpty:0===r.length,emptyMessage:(0,d.t)("No releases were setup for this team’s projects"),emptyAction:(0,P.tZ)(w.ZP,{size:"small",external:!0,href:"https://docs.sentry.io/product/releases/setup/",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Releases Per Project"),(0,P.tZ)(xe,{children:(0,d._N)("Last [period] Average",{period:s})},"last"),(0,P.tZ)(xe,{children:(0,d.t)("Last 7 Days")},"curr"),(0,P.tZ)(xe,{children:(0,d.t)("Difference")},"diff")],children:c.map((e=>{let{project:t}=e;return(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(q.R,{children:(0,P.tZ)(q.W,{avatarSize:18,project:t,to:{pathname:`/organizations/${o.slug}/releases/`,query:{project:t.id}}})}),(0,P.tZ)(be,{children:this.renderReleaseCount(t.id,"period")}),(0,P.tZ)(be,{children:(0,P.tZ)(S.Z,{to:{pathname:`/organizations/${o.slug}/releases/`,query:{project:t.id,statsPeriod:"7d"}},children:this.renderReleaseCount(t.id,"week")})}),(0,P.tZ)(be,{children:this.renderTrend(t.id)})]},t.id)}))})]})}}const ve=(0,de.b)(Ze),fe=(0,s.Z)("div",{target:"e1az29pq5"})("padding:",(0,k.Z)(2)," ",(0,k.Z)(2)," 0 ",(0,k.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),ye=(0,s.Z)(z.Z,{target:"e1az29pq4"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,k.Z)(1)," ",(0,k.Z)(2),";}",(e=>e.isEmpty&&(0,f.iv)("&>div:last-child{padding:48px ",(0,k.Z)(2),";}","")),";"),xe=(0,s.Z)("span",{target:"e1az29pq3"})({name:"2qga7i",styles:"text-align:right"}),be=(0,s.Z)("div",{target:"e1az29pq2"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),we=(0,s.Z)(T.CC,{target:"e1az29pq1"})("margin:0 ",(0,k.Z)(.5),";"),je=(0,s.Z)("div",{target:"e1az29pq0"})("color:",(e=>e.theme[e.color]),";");var Se=r("./app/components/charts/miniBarChart.tsx"),_e=r("./app/components/charts/sessionsRequest.tsx"),ze=r("./app/types/index.tsx"),Te=r("./app/utils/sessions.tsx"),De=r("./app/views/releases/utils/index.tsx");class ke extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,projects:i}=this.props,o=i.filter((e=>e.hasSessions));if(0===o.length)return[];const a={start:t,end:r,period:s,utc:n},l={environment:[],project:o.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,...(0,_.fK)(a)}}],["weekSessions",`/organizations/${e.slug}/sessions/`,{query:{...l,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:s,period:n,utc:i}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===i&&ue()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:s}=this.state,n="week"===t?s:r,i=null==n?void 0:n.groups.filter((t=>t.by.project===e));return(0,Te.Pn)(i,ze.r2.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}getMiniBarChartSeries(e,t){const r=(0,Te.wt)(t.groups.filter((t=>t.by.project===Number(e.id))),ze.r2.SESSIONS,t.intervals),s=(0,Te.iy)(ze.r2.SESSIONS,t.groups.find((t=>t.by.project===Number(e.id)&&t.by["session.status"]===ze.$y.HEALTHY)),t.intervals),n=Array(r.length/7).fill(0);s.forEach(((e,t)=>n[Math.floor(t/7)]+=e.value));const i=Array(r.length/7).fill(0);r.forEach(((e,t)=>i[Math.floor(t/7)]+=e));const o=n.map(((e,t)=>({name:s[7*t].name,value:i[t]?(0,M.$1)(e/i[t]*100,2):0})));return[{seriesName:(0,d.t)("Crash Free Sessions"),data:o}]}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,P.tZ)("div",{children:(0,P.tZ)(me.Z,{width:"80px",height:"25px"})});const s=this.getScore(Number(e),t);return null===s?"—":(0,De.zB)(s)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,P.tZ)("div",{children:(0,P.tZ)(me.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,P.BX)(Be,{color:r>=0?"green300":"red300",children:[`${x()(Math.abs(r),3)}%`,(0,P.tZ)(Re,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{organization:e,projects:t,period:r}=this.props,s=t.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),i=(0,N.NW)(s);return(0,P.tZ)(_e.Z,{api:this.api,project:t.map((e=>{let{id:t}=e;return Number(t)})),organization:e,interval:"1d",groupBy:["session.status","project"],field:[ze.r2.SESSIONS],statsPeriod:r,children:e=>{let{response:s,loading:o}=e;return(0,P.tZ)(qe,{isEmpty:0===t.length,emptyMessage:(0,d.t)("No projects with release health enabled"),emptyAction:(0,P.tZ)(w.ZP,{size:"small",external:!0,href:"https://docs.sentry.io/platforms/dotnet/guides/nlog/configuration/releases/#release-health",children:(0,d.t)("Learn More")}),headers:[(0,d.t)("Project"),(0,P.tZ)(Ne,{children:(0,d._N)("Last [period]",{period:r})},"last"),(0,P.tZ)(Ne,{children:(0,d._N)("[period] Avg",{period:r})},"avg"),(0,P.tZ)(Ne,{children:(0,d.t)("Last 7 Days")},"curr"),(0,P.tZ)(Ne,{children:(0,d.t)("Difference")},"diff")],children:i.map((e=>{let{project:t}=e;return(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(q.R,{children:(0,P.tZ)(q.W,{avatarSize:18,project:t})}),(0,P.tZ)("div",{children:s&&!o&&(0,P.tZ)(Se.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,series:this.getMiniBarChartSeries(t,s),height:25})}),(0,P.tZ)(Pe,{children:this.renderScore(t.id,"period")}),(0,P.tZ)(Pe,{children:this.renderScore(t.id,"week")}),(0,P.tZ)(Pe,{children:this.renderTrend(t.id)})]},t.id)}))})}})}}const Me=ke,qe=(0,s.Z)(z.Z,{target:"e182a5844"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;overflow:visible;&>div{padding:",(0,k.Z)(1)," ",(0,k.Z)(2),";}",(e=>e.isEmpty&&(0,f.iv)("&>div:last-child{padding:48px ",(0,k.Z)(2),";}","")),";"),Ne=(0,s.Z)("span",{target:"e182a5843"})({name:"2qga7i",styles:"text-align:right"}),Pe=(0,s.Z)("div",{target:"e182a5842"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),Re=(0,s.Z)(T.CC,{target:"e182a5841"})("margin:0 ",(0,k.Z)(.5),";"),Be=(0,s.Z)("div",{target:"e182a5840"})("color:",(e=>e.theme[e.color]),";");function Ce(e){var t,r,s,v,f;let{location:y,router:x}=e;const b=(0,p.Z)(),{teams:w,initiallyLoaded:j}=(0,h.Z)({provideUserTeams:!0}),S=null!==(t=null==y?void 0:y.query)&&void 0!==t?t:{},_=`teamInsightsSelectedTeamId:${b.slug}`;let z=null!==(r=S.team)&&void 0!==r?r:u.Z.getItem(_);z&&!w.find((e=>e.id===z))&&(z=null);const T=null!==(s=z)&&void 0!==s?s:null===(v=w[0])||void 0===v?void 0:v.id,D=w.find((e=>e.id===T)),k=null!==(f=null==D?void 0:D.projects)&&void 0!==f?f:[];(0,n.useEffect)((()=>{(0,c.Z)("team_insights.viewed",{organization:b})}),[]);const{period:M,start:q,end:R,utc:C}=(0,N.lI)(S);return 0===w.length?(0,P.tZ)(a.Z,{organization:b,superuserNeedsToBeProjectMember:!0}):(0,P.BX)(n.Fragment,{children:[(0,P.tZ)(l.Z,{title:(0,d.t)("Project Health"),orgSlug:b.slug}),(0,P.tZ)(g.Z,{organization:b,activeTab:"health"}),(0,P.BX)(Ae,{children:[(0,P.tZ)(m.Z,{location:y,router:x,currentTeam:D}),!j&&(0,P.tZ)(o.Z,{}),j&&(0,P.BX)(i.or,{fullWidth:!0,children:[(0,P.tZ)(Z.Z,{title:(0,d.t)("Crash Free Sessions"),description:(0,d.t)("The percentage of healthy, errored, and abnormal sessions that didn’t cause a crash."),children:(0,P.tZ)(Me,{projects:k,organization:b,period:M,start:q,end:R,utc:C})}),(0,P.tZ)(Z.Z,{title:(0,d.t)("User Misery"),description:(0,d.t)("The number of unique users that experienced load times 4x the project’s configured threshold."),children:(0,P.tZ)(U,{organization:b,projects:k,teamId:D.id,period:M,start:null==q?void 0:q.toString(),end:null==R?void 0:R.toString(),location:y})}),(0,P.tZ)(Z.Z,{title:(0,d.t)("Metric Alerts Triggered"),description:(0,d.t)("Alerts triggered from the Alert Rules your team created."),children:(0,P.tZ)(B,{organization:b,projects:k,teamSlug:D.slug,period:M,start:null==q?void 0:q.toString(),end:null==R?void 0:R.toString(),location:y})}),(0,P.tZ)(Z.Z,{title:(0,d.t)("Number of Releases"),description:(0,d.t)("The releases that were created in your team’s projects."),children:(0,P.tZ)(ve,{projects:k,organization:b,teamSlug:D.slug,period:M,start:q,end:R,utc:C})})]})]})]})}Ce.displayName="TeamStatsHealth";const Le=Ce,Ae=(0,s.Z)(i.uT,{target:"e2twaak0"})("margin-bottom:-20px;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:block;}")},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?s(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,s=-1,n=e.length;++s<n;){var i=t(e[s]);void 0!==i&&(r=void 0===r?i:r+i)}return r}},"../node_modules/lodash/mean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseMean.js"),n=r("../node_modules/lodash/identity.js");e.exports=function(e){return s(e,n)}},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseIteratee.js"),n=r("../node_modules/lodash/negate.js"),i=r("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return i(e,n(s(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_health_tsx-node_modules_lodash_mean_js-node_modules_-a7c1d4.40bde73cd3fef3a66035e9bbd1aaba94.js.map