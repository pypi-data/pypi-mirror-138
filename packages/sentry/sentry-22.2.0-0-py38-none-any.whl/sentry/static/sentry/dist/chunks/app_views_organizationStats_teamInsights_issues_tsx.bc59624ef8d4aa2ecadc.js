"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_issues_tsx"],{"./app/views/organizationStats/teamInsights/issues.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ze});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),o=s("./app/components/layouts/thirds.tsx"),i=s("./app/components/loadingIndicator.tsx"),a=s("./app/components/noProjectMessage.tsx"),d=s("./app/components/sentryDocumentTitle.tsx"),l=s("./app/locale.tsx"),u=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),p=s("./app/utils/localStorage.tsx"),c=s("./app/utils/useOrganization.tsx"),g=s("./app/utils/useTeams.tsx"),m=s("./app/views/organizationStats/header.tsx"),h=s("./app/views/organizationStats/teamInsights/controls.tsx"),Z=s("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),v=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),f=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),x=s("../node_modules/moment/moment.js"),y=s.n(x),b=s("./app/components/asyncComponent.tsx"),w=s("./app/components/charts/barChart.tsx"),S=s("./app/components/count.tsx"),j=s("./app/components/idBadge/projectBadge.tsx"),z=s("./app/components/links/link.tsx"),I=s("./app/components/panels/panelTable.tsx"),B=s("./app/components/placeholder.tsx"),k=s("./app/components/timeSince.tsx"),T=s("./app/icons/index.tsx"),C=s("./app/styles/overflowEllipsis.tsx"),D=s("./app/styles/space.tsx"),q=s("./app/utils/events.tsx"),A=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function N(e){if("> 1 year"===e)return y()().subtract(1,"y").subtract(1,"d").valueOf();const[t,s,n]=e.split(" ");return y()().subtract(s,n).valueOf()}const X={"< 1 hour":(0,l.t)("1 hour"),"< 4 hour":(0,l.t)("4 hours"),"< 12 hour":(0,l.t)("12 hours"),"< 1 day":(0,l.t)("1 day"),"< 1 week":(0,l.t)("1 week"),"< 4 week":(0,l.t)("1 month"),"< 24 week":(0,l.t)("6 months"),"< 1 year":(0,l.t)("1 year"),"> 1 year":(0,l.t)("> 1 year")};class O extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),oldestIssues:null,unresolvedIssueAge:null}}getEndpoints(){const{organization:e,teamSlug:t}=this.props;return[["oldestIssues",`/teams/${e.slug}/${t}/issues/old/`,{query:{limit:7}}],["unresolvedIssueAge",`/teams/${e.slug}/${t}/unresolved-issue-age/`]]}componentDidUpdate(e){const{teamSlug:t}=this.props;e.teamSlug!==t&&this.remountComponent()}renderLoading(){return this.renderBody()}renderBody(){const{organization:e}=this.props,{unresolvedIssueAge:t,oldestIssues:s,loading:n}=this.state,o=Object.entries(null!=t?t:{}).map((e=>{let[t,s]=e;return{name:t,value:s}})).sort(((e,t)=>N(t.name)-N(e.name)));return(0,A.BX)("div",{children:[(0,A.BX)(_,{children:[n&&(0,A.tZ)(B.Z,{height:"200px"}),!n&&(0,A.tZ)(w.Z,{style:{height:190},legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:{splitNumber:o.length,type:"category",min:0,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:e=>{var t;return null!==(t=X[e])&&void 0!==t?t:e}}},series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:o,barCategoryGap:"5%"}]})]}),(0,A.tZ)(E,{isEmpty:!s||0===s.length,emptyMessage:(0,l.t)("No unresolved issues for this teamâ€™s projects"),headers:[(0,l.t)("Oldest Issues"),(0,A.tZ)(L,{children:(0,l.t)("Events")},"events"),(0,A.tZ)(L,{children:(0,l.t)("Users")},"users"),(0,A.BX)(L,{children:[(0,l.t)("Age")," ",(0,A.tZ)(T.CC,{direction:"down",size:"12px",color:"gray300"})]},"age")],isLoading:n,children:null==s?void 0:s.map((t=>{const{title:s}=(0,q.YQ)(t,null==e?void 0:e.features,!1);return(0,A.BX)(r.Fragment,{children:[(0,A.BX)(M,{children:[(0,A.tZ)(U,{disableLink:!0,hideName:!0,avatarSize:18,project:t.project}),(0,A.tZ)($,{children:(0,A.tZ)(z.Z,{to:{pathname:`/organizations/${e.slug}/issues/${t.id}/`},children:s})})]}),(0,A.tZ)(L,{children:(0,A.tZ)(S.Z,{value:t.count})}),(0,A.tZ)(L,{children:(0,A.tZ)(S.Z,{value:t.userCount})}),(0,A.tZ)(L,{children:(0,A.tZ)(k.Z,{date:t.firstSeen})})]},t.id)}))})]})}}const R=O,_=(0,n.Z)("div",{target:"e131frq15"})("padding:",(0,D.Z)(2)," ",(0,D.Z)(2)," 0 ",(0,D.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),E=(0,n.Z)(I.Z,{target:"e131frq14"})("grid-template-columns:1fr 0.15fr 0.15fr 0.25fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;>*{padding:",(0,D.Z)(1)," ",(0,D.Z)(2),";}",(e=>e.isEmpty&&(0,f.iv)("&>div:last-child{padding:48px ",(0,D.Z)(2),";}","")),";"),L=(0,n.Z)("span",{target:"e131frq13"})({name:"19mh0x6",styles:"display:flex;align-items:center;justify-content:flex-end"}),M=(0,n.Z)("div",{target:"e131frq12"})(C.Z,";display:flex;align-items:center;"),$=(0,n.Z)("div",{target:"e131frq11"})(C.Z,";"),U=(0,n.Z)(j.Z,{target:"e131frq10"})("display:inline-flex;align-items:center;margin-right:",(0,D.Z)(1),";*>img{box-shadow:none;}");var P=s("../node_modules/lodash/isEqual.js"),F=s.n(P),G=s("./app/components/organizations/pageFilters/parse.tsx"),W=s("./app/stores/projectsStore.tsx"),K=s("./app/views/organizationStats/teamInsights/styles.tsx"),H=s("./app/views/organizationStats/teamInsights/utils.tsx");const Q=["deleted","ignored","resolved","unignored","regressed","new","total"];class Y extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),issuesBreakdown:null}}getEndpoints(){const{organization:e,start:t,end:s,period:n,utc:r,teamSlug:o,statuses:i}=this.props,a={start:t,end:s,period:n,utc:r};return[["issuesBreakdown",`/teams/${e.slug}/${o}/issue-breakdown/`,{query:{...(0,G.fK)(a),statuses:i}}]]}componentDidUpdate(e){const{start:t,end:s,period:n,utc:r,teamSlug:o,projects:i}=this.props;e.start===t&&e.end===s&&e.period===n&&e.utc===r&&e.teamSlug===o&&F()(e.projects,i)||this.remountComponent()}renderLoading(){return this.renderBody()}renderBody(){var e,t,s;const{loading:n}=this.state,o=null!==(e=this.state.issuesBreakdown)&&void 0!==e?e:{},{projects:i,statuses:a}=this.props,d={},u={};for(const[e,t]of Object.entries(o))for(const[s,n]of Object.entries(t)){u[e]||(u[e]={deleted:0,ignored:0,resolved:0,unignored:0,regressed:0,new:0,total:0});for(const t of Q)u[e][t]+=n[t];d[e]||(d[e]={}),void 0===d[e][s]?d[e][s]=n.total:d[e][s]+=n.total}const p=Object.entries(u).map((e=>{let[t,{total:s}]=e;return{projectId:t,total:s}})).sort(((e,t)=>t.total-e.total)),c=Object.keys(d).map(((e,t)=>{var s,n;return{seriesName:null!==(s=null===(n=W.Z.getById(e))||void 0===n?void 0:n.slug)&&void 0!==s?s:e,data:(0,H.bI)((0,H.E7)(d[e])),animationDuration:500,animationDelay:500*t,silent:!0,barCategoryGap:"5%"}}));return(0,A.BX)(r.Fragment,{children:[(0,A.BX)(ee,{children:[n&&(0,A.tZ)(B.Z,{height:"200px"}),!n&&(0,A.tZ)(w.Z,{style:{height:200},stacked:!0,isGroupedByDate:!0,useShortDate:!0,legend:{right:0,top:0},xAxis:(0,H.tP)(null!==(t=null===(s=c[0])||void 0===s?void 0:s.data.length)&&void 0!==t?t:0),yAxis:{minInterval:1},series:c})]}),(0,A.tZ)(te,{numActions:a.length,headers:[(0,l.t)("Project"),...a.map((e=>(0,A.tZ)(se,{children:(0,l.t)(e)},e))),(0,A.BX)(se,{children:[(0,l.t)("total")," ",(0,A.tZ)(T.CC,{direction:"down",size:"12px",color:"gray300"})]},"total")],isLoading:n,children:p.map((e=>{let{projectId:t}=e;const s=i.find((e=>e.id===t));return(0,A.BX)(r.Fragment,{children:[(0,A.tZ)(K.R,{children:s&&(0,A.tZ)(K.W,{avatarSize:18,project:s})}),a.map((e=>(0,A.tZ)(se,{children:u[t][e]},e))),(0,A.tZ)(se,{children:u[t].total})]},t)}))})]})}}const J=Y,V=(0,n.Z)("div",{target:"e1kdpoq3"})("padding:",(0,D.Z)(2)," ",(0,D.Z)(2)," 0 ",(0,D.Z)(2),";"),ee=(0,n.Z)(V,{target:"e1kdpoq2"})("border-bottom:1px solid ",(e=>e.theme.border),";"),te=(0,n.Z)(I.Z,{target:"e1kdpoq1"})("grid-template-columns:1fr ",(e=>" 0.2fr".repeat(e.numActions))," 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,D.Z)(1)," ",(0,D.Z)(2),";}"),se=(0,n.Z)("div",{target:"e1kdpoq0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var ne=s("./app/utils/formatters.tsx");class re extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),resolutionTime:null}}getEndpoints(){const{organization:e,start:t,end:s,period:n,utc:r,teamSlug:o}=this.props,i={start:t,end:s,period:n,utc:r};return[["resolutionTime",`/teams/${e.slug}/${o}/time-to-resolution/`,{query:{...(0,G.fK)(i)}}]]}renderLoading(){return(0,A.tZ)(ie,{children:(0,A.tZ)(i.Z,{})})}renderBody(){const{resolutionTime:e}=this.state,t=Object.entries(null!=e?e:{}).map((e=>{let[t,{avg:s}]=e;return{value:s,name:new Date(t).getTime()}})),s=(0,H.bI)(t);return(0,A.tZ)(ie,{children:(0,A.tZ)(w.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,ne.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,ne.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:(0,H.tP)(s.length),series:[{seriesName:(0,l.t)("Time to Resolution"),data:s,silent:!0,barCategoryGap:"5%"}]})})}}const oe=re,ie=(0,n.Z)("div",{target:"e1s8s0fe0"})("padding:",(0,D.Z)(2)," ",(0,D.Z)(2)," 0 ",(0,D.Z)(2),";");class ae extends b.Z{constructor(){super(...arguments),(0,v.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),periodIssues:null}}getEndpoints(){const{organization:e,start:t,end:s,period:n,utc:r,teamSlug:o}=this.props,i={start:t,end:s,period:n,utc:r};return[["periodIssues",`/teams/${e.slug}/${o}/all-unresolved-issues/`,{query:{...(0,G.fK)(i)}}]]}componentDidUpdate(e){const{teamSlug:t,start:s,end:n,period:r,utc:o}=this.props;e.start===s&&e.end===n&&e.period===r&&e.utc===o&&F()(e.teamSlug,t)||this.remountComponent()}getTotalUnresolved(e){var t;const{periodIssues:s}=this.state,n=Object.values(null!==(t=null==s?void 0:s[e])&&void 0!==t?t:{}),r=n.reduce(((e,t)=>e+t.unresolved),0);return Math.round(r/n.length)}renderLoading(){return this.renderBody()}renderBody(){var e;const{projects:t,period:s}=this.props,{loading:n}=this.state,o=null!==(e=this.state.periodIssues)&&void 0!==e?e:{},i={};for(const e of Object.keys(o)){var a,d,u;const t=this.getTotalUnresolved(Number(e)),s=Object.values(null!==(a=null==o?void 0:o[e])&&void 0!==a?a:{}),n=null!==(d=null===(u=s[s.length-1])||void 0===u?void 0:u.unresolved)&&void 0!==d?d:0,r=Math.abs((n-t)/t);i[e]={projectId:e,periodAvg:t,today:n,percentChange:Number.isNaN(r)?0:r}}const p=t.map((e=>{var t,s;return{project:e,trend:null!==(t=null===(s=i[e.id])||void 0===s?void 0:s.percentChange)&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),c=(0,H.NW)(p),g=Object.values(o).flatMap((e=>Object.entries(e).map((e=>{let[t,{unresolved:s}]=e;return[t,s]})))).reduce(((e,t)=>{let[s,n]=t;return void 0===e[s]&&(e[s]=0),e[s]+=n,e}),{}),m=(0,H.E7)(g).sort(((e,t)=>new Date(e.name).getTime()-new Date(t.name).getTime()));return(0,A.BX)("div",{children:[(0,A.BX)(le,{children:[n&&(0,A.tZ)(B.Z,{height:"200px"}),!n&&(0,A.tZ)(w.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,H.tP)(Math.round(m.length/7)),series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:m,barCategoryGap:"6%"}]})]}),(0,A.tZ)(ue,{isEmpty:0===t.length,isLoading:n,headers:[(0,l.t)("Project"),(0,A.tZ)(pe,{children:(0,l._N)("Last [period] Average",{period:s})},"last"),(0,A.tZ)(pe,{children:(0,l.t)("Today")},"curr"),(0,A.tZ)(pe,{children:(0,l.t)("Change")},"diff")],children:c.map((e=>{var t;let{project:s}=e;const n=null!==(t=i[s.id])&&void 0!==t?t:{};return(0,A.BX)(r.Fragment,{children:[(0,A.tZ)(K.R,{children:(0,A.tZ)(K.W,{avatarSize:18,project:s})}),(0,A.tZ)(ce,{children:n.periodAvg}),(0,A.tZ)(ce,{children:n.today}),(0,A.tZ)(ce,{children:(0,A.BX)(me,{color:0===n.percentChange?"gray300":n.percentChange>0?"red300":"green300",children:[(0,ne.rl)(Number.isNaN(n.percentChange)?0:n.percentChange,0),(0,A.tZ)(ge,{direction:n.percentChange>0?"up":"down",size:"xs"})]})})]},s.id)}))})]})}}const de=ae,le=(0,n.Z)("div",{target:"eahkfcz5"})("padding:",(0,D.Z)(2)," ",(0,D.Z)(2)," 0 ",(0,D.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),ue=(0,n.Z)(I.Z,{target:"eahkfcz4"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,D.Z)(1)," ",(0,D.Z)(2),";}"),pe=(0,n.Z)("span",{target:"eahkfcz3"})({name:"2qga7i",styles:"text-align:right"}),ce=(0,n.Z)("div",{target:"eahkfcz2"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ge=(0,n.Z)(T.CC,{target:"eahkfcz1"})("margin:0 ",(0,D.Z)(.5),";"),me=(0,n.Z)("div",{target:"eahkfcz0"})("color:",(e=>e.theme[e.color]),";");function he(e){var t,s,n,v,f;let{location:x,router:y}=e;const b=(0,c.Z)(),{teams:w,initiallyLoaded:S}=(0,g.Z)({provideUserTeams:!0}),j=null!==(t=null==x?void 0:x.query)&&void 0!==t?t:{},z=`teamInsightsSelectedTeamId:${b.slug}`;let I=null!==(s=j.team)&&void 0!==s?s:p.Z.getItem(z);I&&!w.find((e=>e.id===I))&&(I=null);const B=null!==(n=I)&&void 0!==n?n:null===(v=w[0])||void 0===v?void 0:v.id,k=w.find((e=>e.id===B)),T=null!==(f=null==k?void 0:k.projects)&&void 0!==f?f:[];(0,r.useEffect)((()=>{(0,u.Z)("team_insights.viewed",{organization:b})}),[]);const{period:C,start:D,end:q,utc:N}=(0,H.lI)(j);return 0===w.length?(0,A.tZ)(a.Z,{organization:b,superuserNeedsToBeProjectMember:!0}):(0,A.BX)(r.Fragment,{children:[(0,A.tZ)(d.Z,{title:(0,l.t)("Team Issues"),orgSlug:b.slug}),(0,A.tZ)(m.Z,{organization:b,activeTab:"issues"}),(0,A.BX)(ve,{children:[(0,A.tZ)(h.Z,{location:x,router:y,currentTeam:k}),!S&&(0,A.tZ)(i.Z,{}),S&&(0,A.BX)(o.or,{fullWidth:!0,children:[(0,A.tZ)(Z.Z,{title:(0,l.t)("All Unresolved Issues"),description:(0,l.t)("This includes New and Returning issues in the last 7 days as well as those that havenâ€™t been resolved or ignored in the past."),children:(0,A.tZ)(de,{projects:T,organization:b,teamSlug:k.slug,period:C,start:D,end:q,utc:N})}),(0,A.tZ)(Z.Z,{title:(0,l.t)("New and Returning Issues"),description:(0,l.t)("The new, regressed, and unignored issues that were assigned to your team."),children:(0,A.tZ)(J,{organization:b,projects:T,teamSlug:k.slug,period:C,start:null==D?void 0:D.toString(),end:null==q?void 0:q.toString(),location:x,statuses:["new","regressed","unignored"]})}),(0,A.tZ)(Z.Z,{title:(0,l.t)("Issues Triaged"),description:(0,l.t)("How many new and returning issues were reviewed by your team each week. Reviewing an issue includes marking as reviewed, resolving, assigning to another team, or deleting."),children:(0,A.tZ)(J,{organization:b,projects:T,teamSlug:k.slug,period:C,start:null==D?void 0:D.toString(),end:null==q?void 0:q.toString(),location:x,statuses:["resolved","ignored","deleted"]})}),(0,A.tZ)(Z.Z,{title:(0,l.t)("Age of Unresolved Issues"),description:(0,l.t)("How long ago since unresolved issues were first created."),children:(0,A.tZ)(R,{organization:b,teamSlug:k.slug})}),(0,A.tZ)(Z.Z,{title:(0,l.t)("Time to Resolution"),description:(0,l.t)("The mean time it took for issues to be resolved by your team."),children:(0,A.tZ)(oe,{organization:b,teamSlug:k.slug,period:C,start:null==D?void 0:D.toString(),end:null==q?void 0:q.toString(),location:x})})]})]})]})}he.displayName="TeamStatsIssues";const Ze=he,ve=(0,n.Z)(o.uT,{target:"e16zrx8x0"})("margin-bottom:-20px;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:block;}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_issues_tsx.921299d9eaa96ce08021a0915db7c23c.js.map